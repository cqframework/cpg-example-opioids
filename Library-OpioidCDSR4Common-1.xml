<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1" localId="0">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="Overloads" xsi:type="a:CqlToElmInfo"/>
   <annotation message="An operand identifier [coding] is hiding another identifier of the same name." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation librarySystem="http://cqframework.org/cpg-example-opioids" libraryId="OpioidCDSR4Common" libraryVersion="0.1.0" startLine="74" startChar="7" endLine="74" endChar="53" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="777">
         <a:s>library OpioidCDSR4Common version '0.1.0'</a:s>
      </a:s>
   </annotation>
   <identifier id="OpioidCDSR4Common" system="http://cqframework.org/cpg-example-opioids" version="0.1.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localId="1" localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="206" locator="3:1-3:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.0">
         <annotation xsi:type="a:Annotation">
            <a:s r="206">
               <a:s>using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.0'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="207" locator="5:1-5:54" localIdentifier="FHIRHelpers" path="http://hl7.org/fhir/FHIRHelpers" version="4.0.0">
         <annotation xsi:type="a:Annotation">
            <a:s r="207">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.0' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="208" locator="6:1-6:50" localIdentifier="OMTKLogic" path="http://cqframework.org/cpg-example-opioids/OMTKLogic" version="0.0.0">
         <annotation xsi:type="a:Annotation">
            <a:s r="208">
               <a:s>include </a:s>
               <a:s>
                  <a:s>OMTKLogic</a:s>
               </a:s>
               <a:s> version '0.0.0' called OMTKLogic</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <codeSystems>
      <def localId="209" locator="8:1-8:45" name="SNOMED" id="http://snomed.info/sct" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="209">
               <a:s>codesystem &quot;SNOMED&quot;: 'http://snomed.info/sct'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="210" locator="9:1-9:114" name="Medication Request Category Codes" id="http://terminology.hl7.org/CodeSystem/medicationrequest-category" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="210">
               <a:s>codesystem &quot;Medication Request Category Codes&quot;: 'http://terminology.hl7.org/CodeSystem/medicationrequest-category'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <valueSets>
      <def localId="211" locator="11:1-11:90" name="Active Condition" id="http://hl7.org/fhir/uv/cpg/ValueSet/cpg-active-condition-vs" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="211">
               <a:s>valueset &quot;Active Condition&quot;: 'http://hl7.org/fhir/uv/cpg/ValueSet/cpg-active-condition-vs'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="212" locator="12:1-12:104" name="Benzodiazepines" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/benzodiazepines-medications" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="212">
               <a:s>valueset &quot;Benzodiazepines&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/benzodiazepines-medications'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="213" locator="14:1-14:106" name="End of Life Conditions" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/end-of-life-conditions" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="213">
               <a:s>// TODO: Fix this name
valueset &quot;End of Life Conditions&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/end-of-life-conditions'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="214" locator="18:1-18:100" name="Hospice Disposition" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-disposition" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="214">
               <a:s>// Harvested from VSAC - OID: 2.16.840.1.113762.1.4.1108.15
// NOTE: This harvest note is incorrect, none of the following 3 value sets contain any of the codes in the above referenced valueset
// Rob will construct an appropriate hospice value set aligned with current eCQM program usage and we will use that when available
valueset &quot;Hospice Disposition&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-disposition'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="215" locator="19:1-19:98" name="Hospice Finding Codes" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-finding" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="215">
               <a:s>valueset &quot;Hospice Finding Codes&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-finding'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="216" locator="20:1-20:102" name="Hospice Procedure Codes" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-procedure" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="216">
               <a:s>valueset &quot;Hospice Procedure Codes&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/hospice-procedure'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="217" locator="21:1-21:112" name="Illicit Drug Screening" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/illicit-drug-urine-screening" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="217">
               <a:s>valueset &quot;Illicit Drug Screening&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/illicit-drug-urine-screening'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="218" locator="23:1-23:130" name="Limited Life Expectancy Conditions" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/limited-life-expectancy-conditions" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="218">
               <a:s>// Harvested from VSAC - OID: 2.16.840.1.113883.3.526.3.1259
valueset &quot;Limited Life Expectancy Conditions&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/limited-life-expectancy-conditions'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="219" locator="24:1-24:100" name="Long Acting Opioids" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/long-acting-opioids" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="219">
               <a:s>valueset &quot;Long Acting Opioids&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/long-acting-opioids'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="220" locator="25:1-25:90" name="Naloxone" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/naloxone-medications" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="220">
               <a:s>valueset &quot;Naloxone&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/naloxone-medications'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="221" locator="26:1-26:100" name="Risk Assessment" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioid-abuse-assessment" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="221">
               <a:s>valueset &quot;Risk Assessment&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioid-abuse-assessment'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="222" locator="27:1-27:105" name="Opioid Drug Screening" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioid-urine-screening" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="222">
               <a:s>valueset &quot;Opioid Drug Screening&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioid-urine-screening'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="223" locator="28:1-28:129" name="Ambulatory Abuse Potential Opioids" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioids-abused-in-ambulatory-care" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="223">
               <a:s>valueset &quot;Ambulatory Abuse Potential Opioids&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/opioids-abused-in-ambulatory-care'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="224" locator="29:1-29:92" name="Substance Abuse" id="http://fhir.org/guides/cdc/opioid-cds/ValueSet/substance-abuse" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="224">
               <a:s>valueset &quot;Substance Abuse&quot;: 'http://fhir.org/guides/cdc/opioid-cds/ValueSet/substance-abuse'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <codes>
      <def localId="225" locator="32:1-32:53" name="Referral to Hospice" id="306205009" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="225">
               <a:s>// TODO: Turn this into a valueset
code &quot;Referral to Hospice&quot;: '306205009' from </a:s>
               <a:s r="226">
                  <a:s>&quot;SNOMED&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="226" locator="32:46-32:53" name="SNOMED"/>
      </def>
      <def localId="227" locator="34:1-34:72" name="Outpatient" id="outpatient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="227">
               <a:s>// TODO: Turn this into a valueset
code &quot;Outpatient&quot;: 'outpatient' from </a:s>
               <a:s r="228">
                  <a:s>&quot;Medication Request Category Codes&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="228" locator="34:38-34:72" name="Medication Request Category Codes"/>
      </def>
   </codes>
   <statements>
      <def localId="230" locator="37:1-37:29" name="IsForChronicPain" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="230">
               <a:s r="231">// TODO: Capture process decisions for long-term opioid use
define IsForChronicPain: true</a:s>
            </a:s>
         </annotation>
         <expression localId="231" locator="37:26-37:29" valueType="t:Boolean" value="true" xsi:type="Literal"/>
      </def>
      <def localId="286" locator="238:1-239:27" name="ToCodes" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="286">
               <a:s>define function ToCodes(coding List&lt;FHIR.Coding>):
  </a:s>
               <a:s r="1820">
                  <a:s r="1820">
                     <a:s>
                        <a:s r="1815">
                           <a:s r="1816">
                              <a:s>
                                 <a:s>coding</a:s>
                              </a:s>
                           </a:s>
                           <a:s> c</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="1817">
                        <a:s>return </a:s>
                        <a:s r="1819">
                           <a:s>ToCode(</a:s>
                           <a:s r="1818">
                              <a:s>c</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1820" locator="239:3-239:27" xsi:type="Query">
            <source localId="1815" locator="239:3-239:10" alias="c">
               <expression localId="1816" locator="239:3-239:8" name="coding" xsi:type="OperandRef"/>
            </source>
            <return localId="1817" locator="239:12-239:27">
               <expression localId="1819" locator="239:19-239:27" name="ToCode" xsi:type="FunctionRef">
                  <operand localId="1818" locator="239:26" name="c" xsi:type="AliasRef"/>
               </expression>
            </return>
         </expression>
         <operand localId="289" name="coding">
            <operandTypeSpecifier localId="287" locator="238:32-238:48" xsi:type="ListTypeSpecifier">
               <elementType localId="288" locator="238:37-238:47" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="295" locator="230:1-236:3" name="ToCode" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="295">
               <a:s>/*
*  Conversion Functions
*/

define function ToCode(coding FHIR.Coding):
  </a:s>
               <a:s r="1801">
                  <a:s r="1801">
                     <a:s>System.Code {
    </a:s>
                     <a:s>
                        <a:s>code: </a:s>
                        <a:s r="1805">
                           <a:s r="1804">
                              <a:s r="1803">
                                 <a:s>coding</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1804">
                                 <a:s>code</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1805">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s>
                        <a:s>system: </a:s>
                        <a:s r="1808">
                           <a:s r="1807">
                              <a:s r="1806">
                                 <a:s>coding</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1807">
                                 <a:s>system</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1808">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s>
                        <a:s>version: </a:s>
                        <a:s r="1811">
                           <a:s r="1810">
                              <a:s r="1809">
                                 <a:s>coding</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1810">
                                 <a:s>version</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1811">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s>
                        <a:s>display: </a:s>
                        <a:s r="1814">
                           <a:s r="1813">
                              <a:s r="1812">
                                 <a:s>coding</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1813">
                                 <a:s>display</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1814">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  }</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1801" locator="231:3-236:3" classType="t:Code" xsi:type="Instance">
            <element name="code">
               <value localId="1805" locator="232:11-232:27" path="value" xsi:type="Property">
                  <source localId="1804" locator="232:11-232:21" path="code" xsi:type="Property">
                     <source localId="1803" locator="232:11-232:16" name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="system">
               <value localId="1808" locator="233:13-233:31" path="value" xsi:type="Property">
                  <source localId="1807" locator="233:13-233:25" path="system" xsi:type="Property">
                     <source localId="1806" locator="233:13-233:18" name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="version">
               <value localId="1811" locator="234:14-234:33" path="value" xsi:type="Property">
                  <source localId="1810" locator="234:14-234:27" path="version" xsi:type="Property">
                     <source localId="1809" locator="234:14-234:19" name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="display">
               <value localId="1814" locator="235:14-235:33" path="value" xsi:type="Property">
                  <source localId="1813" locator="235:14-235:27" path="display" xsi:type="Property">
                     <source localId="1812" locator="235:14-235:19" name="coding" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
         </expression>
         <operand localId="297" name="coding">
            <operandTypeSpecifier localId="296" locator="230:31-230:41" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="233" locator="39:1-42:59" name="Active Ambulatory Opioid Rx" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="233">
               <a:s>define &quot;Active Ambulatory Opioid Rx&quot;:
  </a:s>
               <a:s r="316">
                  <a:s>
                     <a:s r="234">
                        <a:s r="264">
                           <a:s r="264">
                              <a:s>[MedicationRequest: </a:s>
                              <a:s>
                                 <a:s>&quot;Ambulatory Abuse Potential Opioids&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> Rx</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="265">
                     <a:s>where </a:s>
                     <a:s r="265">
                        <a:s r="266">
                           <a:s r="268">
                              <a:s r="267">
                                 <a:s>Rx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="268">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="269">
                              <a:s>'active'</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="315">
                           <a:s r="290">
                              <a:s>ToCodes(</a:s>
                              <a:s r="285">
                                 <a:s r="275">
                                    <a:s r="274">
                                       <a:s>Rx</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="275">
                                       <a:s>category</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="285">
                                    <a:s>coding</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> contains </a:s>
                           <a:s r="314">
                              <a:s>&quot;Outpatient&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="316" locator="40:3-42:59" xsi:type="Query">
            <source localId="234" locator="40:3-40:62" alias="Rx">
               <expression localId="264" locator="40:3-40:59" xsi:type="Union">
                  <operand localId="237" dataType="fhir:MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes localId="236" locator="40:23-40:58" name="Ambulatory Abuse Potential Opioids" preserve="true" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="244" locator="40:3-40:59" xsi:type="Query">
                     <source localId="245" locator="40:3-40:59" alias="MR">
                        <expression localId="242" dataType="fhir:MedicationRequest" xsi:type="Retrieve"/>
                     </source>
                     <relationship localId="246" locator="40:3-40:59" alias="M" xsi:type="With">
                        <expression localId="243" dataType="fhir:Medication" xsi:type="Retrieve"/>
                        <suchThat localId="263" xsi:type="And">
                           <operand localId="254" xsi:type="Equal">
                              <signature localId="257" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="258" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="255" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature localId="256" name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="247" path="id" scope="M" xsi:type="Property"/>
                              </operand>
                              <operand localId="253" xsi:type="Last">
                                 <source localId="249" xsi:type="Split">
                                    <stringToSplit localId="251" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="252" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="248" path="medication.reference" scope="MR" xsi:type="Property"/>
                                    </stringToSplit>
                                    <separator localId="250" valueType="t:String" value="/" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                           <operand localId="260" xsi:type="InValueSet">
                              <signature localId="262" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                              <code localId="261" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="259" path="code" scope="M" xsi:type="Property"/>
                              </code>
                              <valueset localId="236" locator="40:23-40:58" name="Ambulatory Abuse Potential Opioids" preserve="true"/>
                           </operand>
                        </suchThat>
                     </relationship>
                  </operand>
               </expression>
            </source>
            <where localId="265" locator="41:5-42:59" xsi:type="And">
               <operand localId="266" locator="41:11-41:30" xsi:type="Equal">
                  <signature localId="272" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="273" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="270" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="271" name="fhir:MedicationRequestStatus" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="268" locator="41:11-41:19" path="status" scope="Rx" xsi:type="Property"/>
                  </operand>
                  <operand localId="269" locator="41:23-41:30" valueType="t:String" value="active" xsi:type="Literal"/>
               </operand>
               <operand localId="315" locator="42:11-42:59" xsi:type="Contains">
                  <operand localId="290" locator="42:11-42:37" name="ToCodes" xsi:type="FunctionRef">
                     <operand localId="285" locator="42:19-42:36" xsi:type="Flatten">
                        <operand localId="283" xsi:type="Query">
                           <source localId="282" alias="$this">
                              <expression localId="275" locator="42:19-42:29" path="category" scope="Rx" xsi:type="Property"/>
                           </source>
                           <where localId="279" xsi:type="Not">
                              <operand localId="278" xsi:type="IsNull">
                                 <operand localId="277" path="coding" xsi:type="Property">
                                    <source localId="276" name="$this" xsi:type="AliasRef"/>
                                 </operand>
                              </operand>
                           </where>
                           <return localId="284" distinct="false">
                              <expression localId="281" path="coding" xsi:type="Property">
                                 <source localId="280" name="$this" xsi:type="AliasRef"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="314" locator="42:48-42:59" name="Outpatient" xsi:type="CodeRef"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="318" locator="44:1-47:59" name="Active Ambulatory Benzodiazepine Rx" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="318">
               <a:s>define &quot;Active Ambulatory Benzodiazepine Rx&quot;:
  </a:s>
               <a:s r="374">
                  <a:s>
                     <a:s r="319">
                        <a:s r="349">
                           <a:s r="349">
                              <a:s>[MedicationRequest: </a:s>
                              <a:s>
                                 <a:s>&quot;Benzodiazepines&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> Rx</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="350">
                     <a:s>where </a:s>
                     <a:s r="350">
                        <a:s r="351">
                           <a:s r="353">
                              <a:s r="352">
                                 <a:s>Rx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="353">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="354">
                              <a:s>'active'</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="373">
                           <a:s r="371">
                              <a:s>ToCodes(</a:s>
                              <a:s r="370">
                                 <a:s r="360">
                                    <a:s r="359">
                                       <a:s>Rx</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="360">
                                       <a:s>category</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="370">
                                    <a:s>coding</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> contains </a:s>
                           <a:s r="372">
                              <a:s>&quot;Outpatient&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="374" locator="45:3-47:59" xsi:type="Query">
            <source localId="319" locator="45:3-45:43" alias="Rx">
               <expression localId="349" locator="45:3-45:40" xsi:type="Union">
                  <operand localId="322" dataType="fhir:MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes localId="321" locator="45:23-45:39" name="Benzodiazepines" preserve="true" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="329" locator="45:3-45:40" xsi:type="Query">
                     <source localId="330" locator="45:3-45:40" alias="MR">
                        <expression localId="327" dataType="fhir:MedicationRequest" xsi:type="Retrieve"/>
                     </source>
                     <relationship localId="331" locator="45:3-45:40" alias="M" xsi:type="With">
                        <expression localId="328" dataType="fhir:Medication" xsi:type="Retrieve"/>
                        <suchThat localId="348" xsi:type="And">
                           <operand localId="339" xsi:type="Equal">
                              <signature localId="342" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="343" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="340" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature localId="341" name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="332" path="id" scope="M" xsi:type="Property"/>
                              </operand>
                              <operand localId="338" xsi:type="Last">
                                 <source localId="334" xsi:type="Split">
                                    <stringToSplit localId="336" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="337" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="333" path="medication.reference" scope="MR" xsi:type="Property"/>
                                    </stringToSplit>
                                    <separator localId="335" valueType="t:String" value="/" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                           <operand localId="345" xsi:type="InValueSet">
                              <signature localId="347" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                              <code localId="346" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="344" path="code" scope="M" xsi:type="Property"/>
                              </code>
                              <valueset localId="321" locator="45:23-45:39" name="Benzodiazepines" preserve="true"/>
                           </operand>
                        </suchThat>
                     </relationship>
                  </operand>
               </expression>
            </source>
            <where localId="350" locator="46:5-47:59" xsi:type="And">
               <operand localId="351" locator="46:11-46:30" xsi:type="Equal">
                  <signature localId="357" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="358" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="355" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="356" name="fhir:MedicationRequestStatus" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="353" locator="46:11-46:19" path="status" scope="Rx" xsi:type="Property"/>
                  </operand>
                  <operand localId="354" locator="46:23-46:30" valueType="t:String" value="active" xsi:type="Literal"/>
               </operand>
               <operand localId="373" locator="47:11-47:59" xsi:type="Contains">
                  <operand localId="371" locator="47:11-47:37" name="ToCodes" xsi:type="FunctionRef">
                     <operand localId="370" locator="47:19-47:36" xsi:type="Flatten">
                        <operand localId="368" xsi:type="Query">
                           <source localId="367" alias="$this">
                              <expression localId="360" locator="47:19-47:29" path="category" scope="Rx" xsi:type="Property"/>
                           </source>
                           <where localId="364" xsi:type="Not">
                              <operand localId="363" xsi:type="IsNull">
                                 <operand localId="362" path="coding" xsi:type="Property">
                                    <source localId="361" name="$this" xsi:type="AliasRef"/>
                                 </operand>
                              </operand>
                           </where>
                           <return localId="369" distinct="false">
                              <expression localId="366" path="coding" xsi:type="Property">
                                 <source localId="365" name="$this" xsi:type="AliasRef"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="372" locator="47:48-47:59" name="Outpatient" xsi:type="CodeRef"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="376" locator="49:1-52:59" name="Active Ambulatory Naloxone Rx" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="376">
               <a:s>define &quot;Active Ambulatory Naloxone Rx&quot;:
  </a:s>
               <a:s r="432">
                  <a:s>
                     <a:s r="377">
                        <a:s r="407">
                           <a:s r="407">
                              <a:s>[MedicationRequest: </a:s>
                              <a:s>
                                 <a:s>&quot;Naloxone&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> Rx</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="408">
                     <a:s>where </a:s>
                     <a:s r="408">
                        <a:s r="409">
                           <a:s r="411">
                              <a:s r="410">
                                 <a:s>Rx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="411">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="412">
                              <a:s>'active'</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="431">
                           <a:s r="429">
                              <a:s>ToCodes(</a:s>
                              <a:s r="428">
                                 <a:s r="418">
                                    <a:s r="417">
                                       <a:s>Rx</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="418">
                                       <a:s>category</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="428">
                                    <a:s>coding</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> contains </a:s>
                           <a:s r="430">
                              <a:s>&quot;Outpatient&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="432" locator="50:3-52:59" xsi:type="Query">
            <source localId="377" locator="50:3-50:36" alias="Rx">
               <expression localId="407" locator="50:3-50:33" xsi:type="Union">
                  <operand localId="380" dataType="fhir:MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes localId="379" locator="50:23-50:32" name="Naloxone" preserve="true" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="387" locator="50:3-50:33" xsi:type="Query">
                     <source localId="388" locator="50:3-50:33" alias="MR">
                        <expression localId="385" dataType="fhir:MedicationRequest" xsi:type="Retrieve"/>
                     </source>
                     <relationship localId="389" locator="50:3-50:33" alias="M" xsi:type="With">
                        <expression localId="386" dataType="fhir:Medication" xsi:type="Retrieve"/>
                        <suchThat localId="406" xsi:type="And">
                           <operand localId="397" xsi:type="Equal">
                              <signature localId="400" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="401" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="398" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature localId="399" name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="390" path="id" scope="M" xsi:type="Property"/>
                              </operand>
                              <operand localId="396" xsi:type="Last">
                                 <source localId="392" xsi:type="Split">
                                    <stringToSplit localId="394" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="395" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="391" path="medication.reference" scope="MR" xsi:type="Property"/>
                                    </stringToSplit>
                                    <separator localId="393" valueType="t:String" value="/" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                           <operand localId="403" xsi:type="InValueSet">
                              <signature localId="405" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                              <code localId="404" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="402" path="code" scope="M" xsi:type="Property"/>
                              </code>
                              <valueset localId="379" locator="50:23-50:32" name="Naloxone" preserve="true"/>
                           </operand>
                        </suchThat>
                     </relationship>
                  </operand>
               </expression>
            </source>
            <where localId="408" locator="51:5-52:59" xsi:type="And">
               <operand localId="409" locator="51:11-51:30" xsi:type="Equal">
                  <signature localId="415" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="416" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="413" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="414" name="fhir:MedicationRequestStatus" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="411" locator="51:11-51:19" path="status" scope="Rx" xsi:type="Property"/>
                  </operand>
                  <operand localId="412" locator="51:23-51:30" valueType="t:String" value="active" xsi:type="Literal"/>
               </operand>
               <operand localId="431" locator="52:11-52:59" xsi:type="Contains">
                  <operand localId="429" locator="52:11-52:37" name="ToCodes" xsi:type="FunctionRef">
                     <operand localId="428" locator="52:19-52:36" xsi:type="Flatten">
                        <operand localId="426" xsi:type="Query">
                           <source localId="425" alias="$this">
                              <expression localId="418" locator="52:19-52:29" path="category" scope="Rx" xsi:type="Property"/>
                           </source>
                           <where localId="422" xsi:type="Not">
                              <operand localId="421" xsi:type="IsNull">
                                 <operand localId="420" path="coding" xsi:type="Property">
                                    <source localId="419" name="$this" xsi:type="AliasRef"/>
                                 </operand>
                              </operand>
                           </where>
                           <return localId="427" distinct="false">
                              <expression localId="424" path="coding" xsi:type="Property">
                                 <source localId="423" name="$this" xsi:type="AliasRef"/>
                              </expression>
                           </return>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="430" locator="52:48-52:59" name="Outpatient" xsi:type="CodeRef"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="434" locator="54:1-56:61" name="Ambulatory Opioid Rx" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="434">
               <a:s>define &quot;Ambulatory Opioid Rx&quot;:
  </a:s>
               <a:s r="481">
                  <a:s>
                     <a:s r="435">
                        <a:s r="465">
                           <a:s r="465">
                              <a:s>[MedicationRequest: </a:s>
                              <a:s>
                                 <a:s>&quot;Ambulatory Abuse Potential Opioids&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> Rx</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
      </a:s>
                  <a:s r="480">
                     <a:s>where </a:s>
                     <a:s r="480">
                        <a:s r="478">
                           <a:s>ToCodes(</a:s>
                           <a:s r="477">
                              <a:s r="467">
                                 <a:s r="466">
                                    <a:s>Rx</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="467">
                                    <a:s>category</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="477">
                                 <a:s>coding</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> contains </a:s>
                        <a:s r="479">
                           <a:s>&quot;Outpatient&quot;</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="481" locator="55:3-56:61" xsi:type="Query">
            <source localId="435" locator="55:3-55:62" alias="Rx">
               <expression localId="465" locator="55:3-55:59" xsi:type="Union">
                  <operand localId="438" dataType="fhir:MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes localId="437" locator="55:23-55:58" name="Ambulatory Abuse Potential Opioids" preserve="true" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="445" locator="55:3-55:59" xsi:type="Query">
                     <source localId="446" locator="55:3-55:59" alias="MR">
                        <expression localId="443" dataType="fhir:MedicationRequest" xsi:type="Retrieve"/>
                     </source>
                     <relationship localId="447" locator="55:3-55:59" alias="M" xsi:type="With">
                        <expression localId="444" dataType="fhir:Medication" xsi:type="Retrieve"/>
                        <suchThat localId="464" xsi:type="And">
                           <operand localId="455" xsi:type="Equal">
                              <signature localId="458" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="459" name="t:String" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="456" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature localId="457" name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="448" path="id" scope="M" xsi:type="Property"/>
                              </operand>
                              <operand localId="454" xsi:type="Last">
                                 <source localId="450" xsi:type="Split">
                                    <stringToSplit localId="452" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="453" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="449" path="medication.reference" scope="MR" xsi:type="Property"/>
                                    </stringToSplit>
                                    <separator localId="451" valueType="t:String" value="/" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                           <operand localId="461" xsi:type="InValueSet">
                              <signature localId="463" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                              <code localId="462" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="460" path="code" scope="M" xsi:type="Property"/>
                              </code>
                              <valueset localId="437" locator="55:23-55:58" name="Ambulatory Abuse Potential Opioids" preserve="true"/>
                           </operand>
                        </suchThat>
                     </relationship>
                  </operand>
               </expression>
            </source>
            <where localId="480" locator="56:7-56:61" xsi:type="Contains">
               <operand localId="478" locator="56:13-56:39" name="ToCodes" xsi:type="FunctionRef">
                  <operand localId="477" locator="56:21-56:38" xsi:type="Flatten">
                     <operand localId="475" xsi:type="Query">
                        <source localId="474" alias="$this">
                           <expression localId="467" locator="56:21-56:31" path="category" scope="Rx" xsi:type="Property"/>
                        </source>
                        <where localId="471" xsi:type="Not">
                           <operand localId="470" xsi:type="IsNull">
                              <operand localId="469" path="coding" xsi:type="Property">
                                 <source localId="468" name="$this" xsi:type="AliasRef"/>
                              </operand>
                           </operand>
                        </where>
                        <return localId="476" distinct="false">
                           <expression localId="473" path="coding" xsi:type="Property">
                              <source localId="472" name="$this" xsi:type="AliasRef"/>
                           </expression>
                        </return>
                     </operand>
                  </operand>
               </operand>
               <operand localId="479" locator="56:50-56:61" name="Outpatient" xsi:type="CodeRef"/>
            </where>
         </expression>
      </def>
      <def localId="483" locator="58:1-104:3" name="End of Life Assessment" context="Unfiltered" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="483">
               <a:s>define &quot;End of Life Assessment&quot;:
  // 1. Conditions indicating end of life or with limited life expectancy
  </a:s>
               <a:s r="484">
                  <a:s r="485">
                     <a:s>exists </a:s>
                     <a:s r="514">
                        <a:s>(
    </a:s>
                        <a:s r="514">
                           <a:s r="499">
                              <a:s>(
      </a:s>
                              <a:s r="499">
                                 <a:s>
                                    <a:s r="486">
                                       <a:s r="489">
                                          <a:s r="489">
                                             <a:s>[Condition: </a:s>
                                             <a:s>
                                                <a:s>&quot;End of Life Conditions&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> C</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="496">
                                    <a:s>where </a:s>
                                    <a:s r="496">
                                       <a:s r="494">
                                          <a:s r="493">
                                             <a:s>C</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="494">
                                             <a:s>clinicalStatus</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> in </a:s>
                                       <a:s r="495">
                                          <a:s>&quot;Active Condition&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                           <a:s>
    union
    </a:s>
                           <a:s r="513">
                              <a:s>(
      </a:s>
                              <a:s r="513">
                                 <a:s>
                                    <a:s r="500">
                                       <a:s r="503">
                                          <a:s r="503">
                                             <a:s>[Condition: </a:s>
                                             <a:s>
                                                <a:s>code</a:s>
                                             </a:s>
                                             <a:s> in </a:s>
                                             <a:s>
                                                <a:s>&quot;Limited Life Expectancy Conditions&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> C</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="510">
                                    <a:s>where </a:s>
                                    <a:s r="510">
                                       <a:s r="508">
                                          <a:s r="507">
                                             <a:s>C</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="508">
                                             <a:s>clinicalStatus</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> in </a:s>
                                       <a:s r="509">
                                          <a:s>&quot;Active Condition&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  // 2. Admitted/referred/discharged to hospice care
  or </a:s>
                  <a:s r="519">
                     <a:s>exists </a:s>
                     <a:s r="686">
                        <a:s>(
    </a:s>
                        <a:s r="686">
                           <a:s r="627">
                              <a:s r="575">
                                 <a:s r="551">
                                    <a:s r="534">
                                       <a:s>(
      </a:s>
                                       <a:s r="534">
                                          <a:s>
                                             <a:s r="520">
                                                <a:s r="523">
                                                   <a:s r="523">
                                                      <a:s>[ServiceRequest: </a:s>
                                                      <a:s>
                                                         <a:s>code</a:s>
                                                      </a:s>
                                                      <a:s> in </a:s>
                                                      <a:s>
                                                         <a:s>&quot;Referral to Hospice&quot;</a:s>
                                                      </a:s>
                                                      <a:s>]</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> RR</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>
        </a:s>
                                          <a:s r="531">
                                             <a:s>where </a:s>
                                             <a:s r="531">
                                                <a:s r="527">
                                                   <a:s r="526">
                                                      <a:s>RR</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="527">
                                                      <a:s>status</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> in </a:s>
                                                <a:s r="528">
                                                   <a:s>{ </a:s>
                                                   <a:s r="529">
                                                      <a:s>'active'</a:s>
                                                   </a:s>
                                                   <a:s>, </a:s>
                                                   <a:s r="530">
                                                      <a:s>'completed'</a:s>
                                                   </a:s>
                                                   <a:s> }</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
    )</a:s>
                                    </a:s>
                                    <a:s>
    union
    </a:s>
                                    <a:s r="550">
                                       <a:s>(
      </a:s>
                                       <a:s r="550">
                                          <a:s>
                                             <a:s r="535">
                                                <a:s r="538">
                                                   <a:s r="538">
                                                      <a:s>[ServiceRequest: </a:s>
                                                      <a:s>
                                                         <a:s>code</a:s>
                                                      </a:s>
                                                      <a:s> in </a:s>
                                                      <a:s>
                                                         <a:s>&quot;Hospice Procedure Codes&quot;</a:s>
                                                      </a:s>
                                                      <a:s>]</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> P</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>
        </a:s>
                                          <a:s r="547">
                                             <a:s>where </a:s>
                                             <a:s r="547">
                                                <a:s r="543">
                                                   <a:s r="542">
                                                      <a:s>P</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="543">
                                                      <a:s>status</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> in </a:s>
                                                <a:s r="544">
                                                   <a:s>{ </a:s>
                                                   <a:s r="545">
                                                      <a:s>'in-progress'</a:s>
                                                   </a:s>
                                                   <a:s>, </a:s>
                                                   <a:s r="546">
                                                      <a:s>'completed'</a:s>
                                                   </a:s>
                                                   <a:s> }</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
    )</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
    union
    </a:s>
                                 <a:s r="574">
                                    <a:s>(
      </a:s>
                                    <a:s r="574">
                                       <a:s>
                                          <a:s r="556">
                                             <a:s r="559">
                                                <a:s r="559">
                                                   <a:s>[ServiceRequest: </a:s>
                                                   <a:s>
                                                      <a:s>code</a:s>
                                                   </a:s>
                                                   <a:s> in </a:s>
                                                   <a:s>
                                                      <a:s>&quot;Hospice Procedure Codes&quot;</a:s>
                                                   </a:s>
                                                   <a:s>]</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> E</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
        </a:s>
                                       <a:s r="571">
                                          <a:s>where </a:s>
                                          <a:s r="571">
                                             <a:s r="564">
                                                <a:s r="563">
                                                   <a:s>E</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="564">
                                                   <a:s>status</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> in </a:s>
                                             <a:s r="565">
                                                <a:s>{ </a:s>
                                                <a:s r="566">
                                                   <a:s>'planned'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="567">
                                                   <a:s>'arrived'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="568">
                                                   <a:s>'in-progress'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="569">
                                                   <a:s>'finished'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="570">
                                                   <a:s>'onleave'</a:s>
                                                </a:s>
                                                <a:s> }</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
    )</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    union
    </a:s>
                              <a:s r="597">
                                 <a:s>(
      </a:s>
                                 <a:s r="597">
                                    <a:s>
                                       <a:s r="580">
                                          <a:s r="583">
                                             <a:s r="583">
                                                <a:s>[Observation: </a:s>
                                                <a:s>
                                                   <a:s>code</a:s>
                                                </a:s>
                                                <a:s> in </a:s>
                                                <a:s>
                                                   <a:s>&quot;Hospice Finding Codes&quot;</a:s>
                                                </a:s>
                                                <a:s>]</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> O</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
        </a:s>
                                    <a:s r="587">
                                       <a:s>where </a:s>
                                       <a:s r="587">
                                          <a:s>not </a:s>
                                          <a:s r="594">
                                             <a:s>(</a:s>
                                             <a:s r="594">
                                                <a:s r="589">
                                                   <a:s r="588">
                                                      <a:s>O</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="589">
                                                      <a:s>status</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> in </a:s>
                                                <a:s r="590">
                                                   <a:s>{ </a:s>
                                                   <a:s r="591">
                                                      <a:s>'unknown'</a:s>
                                                   </a:s>
                                                   <a:s>, </a:s>
                                                   <a:s r="592">
                                                      <a:s>'entered-in-error'</a:s>
                                                   </a:s>
                                                   <a:s>, </a:s>
                                                   <a:s r="593">
                                                      <a:s>'cancelled'</a:s>
                                                   </a:s>
                                                   <a:s> }</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
    )</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    union
    </a:s>
                           <a:s r="673">
                              <a:s>(
      </a:s>
                              <a:s r="673">
                                 <a:s>
                                    <a:s r="636">
                                       <a:s r="637">
                                          <a:s r="637">
                                             <a:s>[Encounter]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> E</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="638">
                                    <a:s>where
          </a:s>
                                    <a:s r="638">
                                       <a:s r="639">
                                          <a:s>(
            </a:s>
                                          <a:s r="639">
                                             <a:s>if </a:s>
                                             <a:s r="640">
                                                <a:s r="645">
                                                   <a:s r="644">
                                                      <a:s r="643">
                                                         <a:s r="642">
                                                            <a:s r="641">
                                                               <a:s>E</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="642">
                                                               <a:s>hospitalization</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="643">
                                                            <a:s>dischargeDisposition</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="644">
                                                         <a:s>coding</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> is null</a:s>
                                                </a:s>
                                                <a:s>
                or </a:s>
                                                <a:s r="646">
                                                   <a:s>not </a:s>
                                                   <a:s r="647">
                                                      <a:s>exists </a:s>
                                                      <a:s r="651">
                                                         <a:s>(</a:s>
                                                         <a:s r="651">
                                                            <a:s r="650">
                                                               <a:s r="649">
                                                                  <a:s r="648">
                                                                     <a:s>E</a:s>
                                                                  </a:s>
                                                                  <a:s>.</a:s>
                                                                  <a:s r="649">
                                                                     <a:s>hospitalization</a:s>
                                                                  </a:s>
                                                               </a:s>
                                                               <a:s>.</a:s>
                                                               <a:s r="650">
                                                                  <a:s>dischargeDisposition</a:s>
                                                               </a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="651">
                                                               <a:s>coding</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s>)</a:s>
                                                      </a:s>
                                                   </a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="654">
              then false
            else </a:s>
                                             <a:s r="659">
                                                <a:s r="657">
                                                   <a:s r="656">
                                                      <a:s r="655">
                                                         <a:s>E</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="656">
                                                         <a:s>hospitalization</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="657">
                                                      <a:s>dischargeDisposition</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> in </a:s>
                                                <a:s r="658">
                                                   <a:s>&quot;Hospice Disposition&quot;</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>
          )</a:s>
                                       </a:s>
                                       <a:s>
          and </a:s>
                                       <a:s r="670">
                                          <a:s r="663">
                                             <a:s r="662">
                                                <a:s>E</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="663">
                                                <a:s>status</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> in </a:s>
                                          <a:s r="664">
                                             <a:s>{ </a:s>
                                             <a:s r="665">
                                                <a:s>'planned'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="666">
                                                <a:s>'arrived'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="667">
                                                <a:s>'in-progress'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="668">
                                                <a:s>'finished'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="669">
                                                <a:s>'onleave'</a:s>
                                             </a:s>
                                             <a:s> }</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="484" locator="60:3-104:3" xsi:type="Or">
            <operand localId="485" locator="60:3-70:3" xsi:type="Exists">
               <operand localId="514" locator="60:10-70:3" xsi:type="Union">
                  <signature localId="515" xsi:type="ListTypeSpecifier">
                     <elementType localId="516" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <signature localId="517" xsi:type="ListTypeSpecifier">
                     <elementType localId="518" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="499" locator="61:5-64:5" xsi:type="Query">
                     <source localId="486" locator="62:7-62:45" alias="C">
                        <expression localId="489" locator="62:7-62:43" dataType="fhir:Condition" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes localId="488" locator="62:19-62:42" name="End of Life Conditions" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="496" locator="63:9-63:52" xsi:type="InValueSet">
                        <signature localId="498" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                        <code localId="497" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <operand localId="494" locator="63:15-63:30" path="clinicalStatus" scope="C" xsi:type="Property"/>
                        </code>
                        <valueset localId="495" locator="63:35-63:52" name="Active Condition" preserve="true"/>
                     </where>
                  </operand>
                  <operand localId="513" locator="66:5-69:5" xsi:type="Query">
                     <source localId="500" locator="67:7-67:65" alias="C">
                        <expression localId="503" locator="67:7-67:63" dataType="fhir:Condition" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes localId="502" locator="67:27-67:62" name="Limited Life Expectancy Conditions" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="510" locator="68:9-68:52" xsi:type="InValueSet">
                        <signature localId="512" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                        <code localId="511" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <operand localId="508" locator="68:15-68:30" path="clinicalStatus" scope="C" xsi:type="Property"/>
                        </code>
                        <valueset localId="509" locator="68:35-68:52" name="Active Condition" preserve="true"/>
                     </where>
                  </operand>
               </operand>
            </operand>
            <operand localId="519" locator="72:6-104:3" xsi:type="Exists">
               <signature localId="697" xsi:type="ListTypeSpecifier">
                  <elementType localId="698" xsi:type="ChoiceTypeSpecifier">
                     <choice localId="699" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                     <choice localId="700" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     <choice localId="701" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </elementType>
               </signature>
               <operand localId="686" locator="72:13-104:3" xsi:type="Union">
                  <signature localId="687" xsi:type="ListTypeSpecifier">
                     <elementType localId="688" xsi:type="ChoiceTypeSpecifier">
                        <choice localId="689" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                        <choice localId="690" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        <choice localId="691" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                     </elementType>
                  </signature>
                  <signature localId="692" xsi:type="ListTypeSpecifier">
                     <elementType localId="693" xsi:type="ChoiceTypeSpecifier">
                        <choice localId="694" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                        <choice localId="695" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        <choice localId="696" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                     </elementType>
                  </signature>
                  <operand localId="674" xsi:type="As">
                     <operand localId="627" locator="73:5-91:5" xsi:type="Union">
                        <signature localId="628" xsi:type="ListTypeSpecifier">
                           <elementType localId="629" xsi:type="ChoiceTypeSpecifier">
                              <choice localId="630" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                              <choice localId="631" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </elementType>
                        </signature>
                        <signature localId="632" xsi:type="ListTypeSpecifier">
                           <elementType localId="633" xsi:type="ChoiceTypeSpecifier">
                              <choice localId="634" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                              <choice localId="635" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </elementType>
                        </signature>
                        <operand localId="617" xsi:type="As">
                           <operand localId="551" locator="73:5-81:5" xsi:type="Union">
                              <signature localId="552" xsi:type="ListTypeSpecifier">
                                 <elementType localId="553" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <signature localId="554" xsi:type="ListTypeSpecifier">
                                 <elementType localId="555" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand localId="534" locator="73:5-76:5" xsi:type="Query">
                                 <source localId="520" locator="74:7-74:56" alias="RR">
                                    <expression localId="523" locator="74:7-74:53" dataType="fhir:ServiceRequest" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                                       <codes localId="525" xsi:type="ToList">
                                          <operand localId="522" locator="74:32-74:52" name="Referral to Hospice" xsi:type="CodeRef"/>
                                       </codes>
                                    </expression>
                                 </source>
                                 <where localId="531" locator="75:9-75:52" xsi:type="In">
                                    <operand localId="532" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="533" name="fhir:RequestStatus" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="527" locator="75:15-75:23" path="status" scope="RR" xsi:type="Property"/>
                                    </operand>
                                    <operand localId="528" locator="75:28-75:52" xsi:type="List">
                                       <element localId="529" locator="75:30-75:37" valueType="t:String" value="active" xsi:type="Literal"/>
                                       <element localId="530" locator="75:40-75:50" valueType="t:String" value="completed" xsi:type="Literal"/>
                                    </operand>
                                 </where>
                              </operand>
                              <operand localId="550" locator="78:5-81:5" xsi:type="Query">
                                 <source localId="535" locator="79:7-79:59" alias="P">
                                    <expression localId="538" locator="79:7-79:57" dataType="fhir:ServiceRequest" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                                       <codes localId="537" locator="79:32-79:56" name="Hospice Procedure Codes" preserve="true" xsi:type="ValueSetRef"/>
                                    </expression>
                                 </source>
                                 <where localId="547" locator="80:9-80:56" xsi:type="In">
                                    <operand localId="548" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature localId="549" name="fhir:RequestStatus" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="543" locator="80:15-80:22" path="status" scope="P" xsi:type="Property"/>
                                    </operand>
                                    <operand localId="544" locator="80:27-80:56" xsi:type="List">
                                       <element localId="545" locator="80:29-80:41" valueType="t:String" value="in-progress" xsi:type="Literal"/>
                                       <element localId="546" locator="80:44-80:54" valueType="t:String" value="completed" xsi:type="Literal"/>
                                    </operand>
                                 </where>
                              </operand>
                           </operand>
                           <asTypeSpecifier localId="618" xsi:type="ListTypeSpecifier">
                              <elementType localId="619" xsi:type="ChoiceTypeSpecifier">
                                 <choice localId="620" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                 <choice localId="621" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                              </elementType>
                           </asTypeSpecifier>
                        </operand>
                        <operand localId="622" xsi:type="As">
                           <operand localId="608" xsi:type="Union">
                              <signature localId="609" xsi:type="ListTypeSpecifier">
                                 <elementType localId="610" xsi:type="ChoiceTypeSpecifier">
                                    <choice localId="611" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                    <choice localId="612" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                                 </elementType>
                              </signature>
                              <signature localId="613" xsi:type="ListTypeSpecifier">
                                 <elementType localId="614" xsi:type="ChoiceTypeSpecifier">
                                    <choice localId="615" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                    <choice localId="616" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                                 </elementType>
                              </signature>
                              <operand localId="598" xsi:type="As">
                                 <operand localId="574" locator="83:5-86:5" xsi:type="Query">
                                    <source localId="556" locator="84:7-84:59" alias="E">
                                       <expression localId="559" locator="84:7-84:57" dataType="fhir:ServiceRequest" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                                          <codes localId="558" locator="84:32-84:56" name="Hospice Procedure Codes" preserve="true" xsi:type="ValueSetRef"/>
                                       </expression>
                                    </source>
                                    <where localId="571" locator="85:9-85:88" xsi:type="In">
                                       <operand localId="572" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature localId="573" name="fhir:RequestStatus" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="564" locator="85:15-85:22" path="status" scope="E" xsi:type="Property"/>
                                       </operand>
                                       <operand localId="565" locator="85:27-85:88" xsi:type="List">
                                          <element localId="566" locator="85:29-85:37" valueType="t:String" value="planned" xsi:type="Literal"/>
                                          <element localId="567" locator="85:40-85:48" valueType="t:String" value="arrived" xsi:type="Literal"/>
                                          <element localId="568" locator="85:51-85:63" valueType="t:String" value="in-progress" xsi:type="Literal"/>
                                          <element localId="569" locator="85:66-85:75" valueType="t:String" value="finished" xsi:type="Literal"/>
                                          <element localId="570" locator="85:78-85:86" valueType="t:String" value="onleave" xsi:type="Literal"/>
                                       </operand>
                                    </where>
                                 </operand>
                                 <asTypeSpecifier localId="599" xsi:type="ListTypeSpecifier">
                                    <elementType localId="600" xsi:type="ChoiceTypeSpecifier">
                                       <choice localId="601" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                       <choice localId="602" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                                    </elementType>
                                 </asTypeSpecifier>
                              </operand>
                              <operand localId="603" xsi:type="As">
                                 <operand localId="597" locator="88:5-91:5" xsi:type="Query">
                                    <source localId="580" locator="89:7-89:54" alias="O">
                                       <expression localId="583" locator="89:7-89:52" dataType="fhir:Observation" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                                          <codes localId="582" locator="89:29-89:51" name="Hospice Finding Codes" preserve="true" xsi:type="ValueSetRef"/>
                                       </expression>
                                    </source>
                                    <where localId="587" locator="90:9-90:78" xsi:type="Not">
                                       <operand localId="594" locator="90:19-90:78" xsi:type="In">
                                          <operand localId="595" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <signature localId="596" name="fhir:ObservationStatus" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="589" locator="90:20-90:27" path="status" scope="O" xsi:type="Property"/>
                                          </operand>
                                          <operand localId="590" locator="90:32-90:77" xsi:type="List">
                                             <element localId="591" locator="90:34-90:42" valueType="t:String" value="unknown" xsi:type="Literal"/>
                                             <element localId="592" locator="90:45-90:62" valueType="t:String" value="entered-in-error" xsi:type="Literal"/>
                                             <element localId="593" locator="90:65-90:75" valueType="t:String" value="cancelled" xsi:type="Literal"/>
                                          </operand>
                                       </operand>
                                    </where>
                                 </operand>
                                 <asTypeSpecifier localId="604" xsi:type="ListTypeSpecifier">
                                    <elementType localId="605" xsi:type="ChoiceTypeSpecifier">
                                       <choice localId="606" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                       <choice localId="607" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                                    </elementType>
                                 </asTypeSpecifier>
                              </operand>
                           </operand>
                           <asTypeSpecifier localId="623" xsi:type="ListTypeSpecifier">
                              <elementType localId="624" xsi:type="ChoiceTypeSpecifier">
                                 <choice localId="625" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                                 <choice localId="626" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                              </elementType>
                           </asTypeSpecifier>
                        </operand>
                     </operand>
                     <asTypeSpecifier localId="675" xsi:type="ListTypeSpecifier">
                        <elementType localId="676" xsi:type="ChoiceTypeSpecifier">
                           <choice localId="677" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                           <choice localId="678" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           <choice localId="679" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </elementType>
                     </asTypeSpecifier>
                  </operand>
                  <operand localId="680" xsi:type="As">
                     <operand localId="673" locator="93:5-103:5" xsi:type="Query">
                        <source localId="636" locator="94:7-94:19" alias="E">
                           <expression localId="637" locator="94:7-94:17" dataType="fhir:Encounter" xsi:type="Retrieve"/>
                        </source>
                        <where localId="638" locator="95:9-102:88" xsi:type="And">
                           <operand localId="639" locator="96:11-101:11" xsi:type="If">
                              <condition localId="640" locator="97:16-98:77" xsi:type="Or">
                                 <operand localId="645" locator="97:16-97:68" xsi:type="IsNull">
                                    <operand localId="644" locator="97:16-97:60" path="coding" xsi:type="Property">
                                       <source localId="643" locator="97:16-97:53" path="dischargeDisposition" xsi:type="Property">
                                          <source localId="642" locator="97:16-97:32" path="hospitalization" scope="E" xsi:type="Property"/>
                                       </source>
                                    </operand>
                                 </operand>
                                 <operand localId="646" locator="98:20-98:77" xsi:type="Not">
                                    <operand localId="647" locator="98:24-98:77" xsi:type="Exists">
                                       <signature localId="652" xsi:type="ListTypeSpecifier">
                                          <elementType localId="653" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
                                       </signature>
                                       <operand localId="651" locator="98:31-98:77" path="coding" xsi:type="Property">
                                          <source localId="650" locator="98:32-98:69" path="dischargeDisposition" xsi:type="Property">
                                             <source localId="649" locator="98:32-98:48" path="hospitalization" scope="E" xsi:type="Property"/>
                                          </source>
                                       </operand>
                                    </operand>
                                 </operand>
                              </condition>
                              <then localId="654" locator="99:20-99:24" valueType="t:Boolean" value="false" xsi:type="Literal"/>
                              <else localId="659" locator="100:18-100:80" xsi:type="InValueSet">
                                 <signature localId="661" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                                 <code localId="660" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <operand localId="657" locator="100:18-100:55" path="dischargeDisposition" xsi:type="Property">
                                       <source localId="656" locator="100:18-100:34" path="hospitalization" scope="E" xsi:type="Property"/>
                                    </operand>
                                 </code>
                                 <valueset localId="658" locator="100:60-100:80" name="Hospice Disposition" preserve="true"/>
                              </else>
                           </operand>
                           <operand localId="670" locator="102:15-102:88" xsi:type="In">
                              <operand localId="671" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature localId="672" name="fhir:EncounterStatus" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="663" locator="102:15-102:22" path="status" scope="E" xsi:type="Property"/>
                              </operand>
                              <operand localId="664" locator="102:27-102:88" xsi:type="List">
                                 <element localId="665" locator="102:29-102:37" valueType="t:String" value="planned" xsi:type="Literal"/>
                                 <element localId="666" locator="102:40-102:48" valueType="t:String" value="arrived" xsi:type="Literal"/>
                                 <element localId="667" locator="102:51-102:63" valueType="t:String" value="in-progress" xsi:type="Literal"/>
                                 <element localId="668" locator="102:66-102:75" valueType="t:String" value="finished" xsi:type="Literal"/>
                                 <element localId="669" locator="102:78-102:86" valueType="t:String" value="onleave" xsi:type="Literal"/>
                              </operand>
                           </operand>
                        </where>
                     </operand>
                     <asTypeSpecifier localId="681" xsi:type="ListTypeSpecifier">
                        <elementType localId="682" xsi:type="ChoiceTypeSpecifier">
                           <choice localId="683" name="fhir:ServiceRequest" xsi:type="NamedTypeSpecifier"/>
                           <choice localId="684" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           <choice localId="685" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </elementType>
                     </asTypeSpecifier>
                  </operand>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="702" locator="106:1-149:5" name="Prescriptions" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="702">
               <a:s>define function Prescriptions(Orders List&lt;MedicationRequest>):
  </a:s>
               <a:s r="996">
                  <a:s r="996">
                     <a:s>
                        <a:s r="706">
                           <a:s r="707">
                              <a:s>
                                 <a:s>Orders</a:s>
                              </a:s>
                           </a:s>
                           <a:s> O</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let
      // NOTE: Assuming medication is specified as a CodeableConcept with a single RxNorm code
      </a:s>
                        <a:s r="708">
                           <a:s>rxNormCode: </a:s>
                           <a:s r="717">
                              <a:s>ToCode(</a:s>
                              <a:s r="709">
                                 <a:s r="712">
                                    <a:s r="711">
                                       <a:s r="710">
                                          <a:s>O</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="711">
                                          <a:s>medication</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="712">
                                       <a:s>coding</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s r="713">[0]</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="718">
                           <a:s>medicationName: </a:s>
                           <a:s r="721">
                              <a:s r="719">
                                 <a:s>OMTKLogic</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="721">
                                 <a:s>GetMedicationName(</a:s>
                                 <a:s r="720">
                                    <a:s>rxNormCode</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      // NOTE: Assuming a single dosage instruction element
      </a:s>
                        <a:s r="722">
                           <a:s>dosageInstruction: </a:s>
                           <a:s r="723">
                              <a:s r="725">
                                 <a:s r="724">
                                    <a:s>O</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="725">
                                    <a:s>dosageInstruction</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="726">[0]</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="730">
                           <a:s>repeat: </a:s>
                           <a:s r="733">
                              <a:s r="732">
                                 <a:s r="731">
                                    <a:s>dosageInstruction</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="732">
                                    <a:s>timing</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="733">
                                 <a:s>repeat</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="734">
                           <a:s>frequency: </a:s>
                           <a:s r="743">
                              <a:s>Coalesce(</a:s>
                              <a:s r="737">
                                 <a:s r="736">
                                    <a:s r="735">
                                       <a:s>repeat</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="736">
                                       <a:s>frequencyMax</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="737">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="740">
                                 <a:s r="739">
                                    <a:s r="738">
                                       <a:s>repeat</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="739">
                                       <a:s>frequency</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="740">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="744">
                           <a:s>period: </a:s>
                           <a:s r="745">
                              <a:s>System.Quantity { </a:s>
                              <a:s>
                                 <a:s>value: </a:s>
                                 <a:s r="749">
                                    <a:s r="748">
                                       <a:s r="747">
                                          <a:s>repeat</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="748">
                                          <a:s>period</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="749">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s>
                                 <a:s>unit: </a:s>
                                 <a:s r="752">
                                    <a:s r="751">
                                       <a:s r="750">
                                          <a:s>repeat</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="751">
                                          <a:s>periodUnit</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="752">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> }</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="753">
                           <a:s>doseDescription:
        </a:s>
                           <a:s r="850">
                              <a:s>Coalesce(
          // There should be a conversion from FHIR.SimpleQuantity to System.Quantity
          </a:s>
                              <a:s r="754">
                                 <a:s>if </a:s>
                                 <a:s r="755">
                                    <a:s r="763">
                                       <a:s r="756">
                                          <a:s r="758">
                                             <a:s r="757">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="758">
                                                <a:s>doseAndRate</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="759">[0]</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="763">
                                          <a:s>dose</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="764">
                                       <a:s>FHIR.Range</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
            then </a:s>
                                 <a:s r="829">
                                    <a:s r="815">
                                       <a:s r="797">
                                          <a:s r="792">
                                             <a:s>ToString(</a:s>
                                             <a:s r="780">
                                                <a:s>ToQuantity(</a:s>
                                                <a:s r="776">
                                                   <a:s r="775">
                                                      <a:s r="768">
                                                         <a:s r="770">
                                                            <a:s r="769">
                                                               <a:s>dosageInstruction</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="770">
                                                               <a:s>doseAndRate</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s r="771">[0]</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="775">
                                                         <a:s>dose</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="776">
                                                      <a:s>low</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>
                          + </a:s>
                                          <a:s r="794">
                                             <a:s>'-'</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="811">
                                          <a:s>ToString(</a:s>
                                          <a:s r="807">
                                             <a:s>ToQuantity(</a:s>
                                             <a:s r="806">
                                                <a:s r="805">
                                                   <a:s r="798">
                                                      <a:s r="800">
                                                         <a:s r="799">
                                                            <a:s>dosageInstruction</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="800">
                                                            <a:s>doseAndRate</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s r="801">[0]</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="805">
                                                      <a:s>dose</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="806">
                                                   <a:s>high</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
                          + </a:s>
                                    <a:s r="826">
                                       <a:s r="825">
                                          <a:s r="824">
                                             <a:s r="823">
                                                <a:s r="816">
                                                   <a:s r="818">
                                                      <a:s r="817">
                                                         <a:s>dosageInstruction</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="818">
                                                         <a:s>doseAndRate</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s r="819">[0]</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="823">
                                                   <a:s>dose</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="824">
                                                <a:s>high</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="825">
                                             <a:s>unit</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="826">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
            else </a:s>
                                 <a:s r="843">
                                    <a:s>ToString(</a:s>
                                    <a:s r="838">
                                       <a:s>ToQuantity(</a:s>
                                       <a:s r="837">
                                          <a:s r="830">
                                             <a:s r="832">
                                                <a:s r="831">
                                                   <a:s>dosageInstruction</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="832">
                                                   <a:s>doseAndRate</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="833">[0]</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="837">
                                             <a:s>dose</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>,
            </a:s>
                              <a:s r="845">
                                 <a:s>''</a:s>
                              </a:s>
                              <a:s>
        )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="853">
                           <a:s>frequencyDescription:
        </a:s>
                           <a:s r="890">
                              <a:s r="863">
                                 <a:s>ToString(</a:s>
                                 <a:s r="859">
                                    <a:s r="858">
                                       <a:s r="857">
                                          <a:s r="856">
                                             <a:s r="855">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="856">
                                                <a:s>timing</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="857">
                                             <a:s>repeat</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="858">
                                          <a:s>frequency</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="859">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> +
          </a:s>
                              <a:s r="885">
                                 <a:s>Coalesce(
            </a:s>
                                 <a:s r="879">
                                    <a:s r="866">
                                       <a:s>'-'</a:s>
                                    </a:s>
                                    <a:s> + </a:s>
                                    <a:s r="875">
                                       <a:s>ToString(</a:s>
                                       <a:s r="871">
                                          <a:s r="870">
                                             <a:s r="869">
                                                <a:s r="868">
                                                   <a:s r="867">
                                                      <a:s>dosageInstruction</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="868">
                                                      <a:s>timing</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="869">
                                                   <a:s>repeat</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="870">
                                                <a:s>frequencyMax</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="871">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
            </a:s>
                                 <a:s r="880">
                                    <a:s>''</a:s>
                                 </a:s>
                                 <a:s>
          )</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="891">
                        <a:s>return </a:s>
                        <a:s r="892">
                           <a:s>{
      </a:s>
                           <a:s>
                              <a:s>rxNormCode: </a:s>
                              <a:s r="893">
                                 <a:s>rxNormCode</a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>isDraft: </a:s>
                              <a:s r="894">
                                 <a:s r="897">
                                    <a:s r="896">
                                       <a:s r="895">
                                          <a:s>O</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="896">
                                          <a:s>status</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="897">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="898">
                                    <a:s>'draft'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      // NOTE: Assuming asNeeded is expressed as a boolean
      </a:s>
                           <a:s>
                              <a:s>isPRN: </a:s>
                              <a:s r="903">
                                 <a:s r="902">
                                    <a:s r="901">
                                       <a:s>dosageInstruction</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="902">
                                       <a:s>asNeeded</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="903">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>prescription:
        </a:s>
                              <a:s r="904">
                                 <a:s>if </a:s>
                                 <a:s r="908">
                                    <a:s r="906">
                                       <a:s r="905">
                                          <a:s>dosageInstruction</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="906">
                                          <a:s>text</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is not null</a:s>
                                 </a:s>
                                 <a:s> then
          </a:s>
                                 <a:s r="921">
                                    <a:s r="915">
                                       <a:s r="911">
                                          <a:s>medicationName</a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="912">
                                          <a:s>' '</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> + </a:s>
                                    <a:s r="918">
                                       <a:s r="917">
                                          <a:s r="916">
                                             <a:s>dosageInstruction</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="917">
                                             <a:s>text</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="918">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        else
          // TODO: Shouldn't need the .value here on asNeededBoolean
          </a:s>
                                 <a:s r="952">
                                    <a:s r="943">
                                       <a:s r="939">
                                          <a:s r="935">
                                             <a:s r="931">
                                                <a:s r="927">
                                                   <a:s>medicationName</a:s>
                                                </a:s>
                                                <a:s> + </a:s>
                                                <a:s r="928">
                                                   <a:s>' '</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> + </a:s>
                                             <a:s r="932">
                                                <a:s>doseDescription</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> + </a:s>
                                          <a:s r="936">
                                             <a:s>' q'</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="940">
                                          <a:s>frequencyDescription</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> + </a:s>
                                    <a:s r="944">
                                       <a:s>(</a:s>
                                       <a:s r="944">
                                          <a:s>if </a:s>
                                          <a:s r="947">
                                             <a:s r="946">
                                                <a:s r="945">
                                                   <a:s>dosageInstruction</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="946">
                                                   <a:s>asNeeded</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="947">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> then </a:s>
                                          <a:s r="948">
                                             <a:s>' PRN'</a:s>
                                          </a:s>
                                          <a:s> else </a:s>
                                          <a:s r="949">
                                             <a:s>''</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      // TODO: Shouldn't need the ToQuantity here...
      </a:s>
                           <a:s>
                              <a:s>dose: </a:s>
                              <a:s r="953">
                                 <a:s>if </a:s>
                                 <a:s r="954">
                                    <a:s r="962">
                                       <a:s r="955">
                                          <a:s r="957">
                                             <a:s r="956">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="957">
                                                <a:s>doseAndRate</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="958">[0]</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="962">
                                          <a:s>dose</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="963">
                                       <a:s>FHIR.Range</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
            then </a:s>
                                 <a:s r="973">
                                    <a:s>ToQuantity(</a:s>
                                    <a:s r="972">
                                       <a:s r="971">
                                          <a:s r="964">
                                             <a:s r="966">
                                                <a:s r="965">
                                                   <a:s>dosageInstruction</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="966">
                                                   <a:s>doseAndRate</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="967">[0]</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="971">
                                             <a:s>dose</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="972">
                                          <a:s>high</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>
            else </a:s>
                                 <a:s r="982">
                                    <a:s>ToQuantity(</a:s>
                                    <a:s r="981">
                                       <a:s r="974">
                                          <a:s r="976">
                                             <a:s r="975">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="976">
                                                <a:s>doseAndRate</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="977">[0]</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="981">
                                          <a:s>dose</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>dosesPerDay: </a:s>
                              <a:s r="993">
                                 <a:s>Coalesce(</a:s>
                                 <a:s r="987">
                                    <a:s r="984">
                                       <a:s>OMTKLogic</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="987">
                                       <a:s>ToDaily(</a:s>
                                       <a:s r="985">
                                          <a:s>frequency</a:s>
                                       </a:s>
                                       <a:s>, </a:s>
                                       <a:s r="986">
                                          <a:s>period</a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s r="988">, 1.0)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    }</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="996" locator="107:3-149:5" xsi:type="Query">
            <source localId="706" locator="107:3-107:10" alias="O">
               <expression localId="707" locator="107:3-107:8" name="Orders" xsi:type="OperandRef"/>
            </source>
            <let localId="708" locator="110:7-110:48" identifier="rxNormCode">
               <expression localId="717" locator="110:19-110:48" name="ToCode" xsi:type="FunctionRef">
                  <operand localId="709" locator="110:26-110:47" xsi:type="Indexer">
                     <signature localId="714" xsi:type="ListTypeSpecifier">
                        <elementType localId="715" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <signature localId="716" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="712" locator="110:26-110:44" path="coding" xsi:type="Property">
                        <source localId="711" locator="110:26-110:37" path="medication" scope="O" xsi:type="Property"/>
                     </operand>
                     <operand localId="713" locator="110:46" valueType="t:Integer" value="0" xsi:type="Literal"/>
                  </operand>
               </expression>
            </let>
            <let localId="718" locator="111:7-111:61" identifier="medicationName">
               <expression localId="721" locator="111:23-111:61" name="GetMedicationName" libraryName="OMTKLogic" xsi:type="FunctionRef">
                  <operand localId="720" locator="111:51-111:60" name="rxNormCode" xsi:type="QueryLetRef"/>
               </expression>
            </let>
            <let localId="722" locator="113:7-113:47" identifier="dosageInstruction">
               <expression localId="723" locator="113:26-113:47" xsi:type="Indexer">
                  <signature localId="727" xsi:type="ListTypeSpecifier">
                     <elementType localId="728" name="fhir:Dosage" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <signature localId="729" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="725" locator="113:26-113:44" path="dosageInstruction" scope="O" xsi:type="Property"/>
                  <operand localId="726" locator="113:46" valueType="t:Integer" value="0" xsi:type="Literal"/>
               </expression>
            </let>
            <let localId="730" locator="114:7-114:45" identifier="repeat">
               <expression localId="733" locator="114:15-114:45" path="repeat" xsi:type="Property">
                  <source localId="732" locator="114:15-114:38" path="timing" xsi:type="Property">
                     <source localId="731" locator="114:15-114:31" name="dosageInstruction" xsi:type="QueryLetRef"/>
                  </source>
               </expression>
            </let>
            <let localId="734" locator="115:7-115:76" identifier="frequency">
               <expression localId="743" locator="115:18-115:76" xsi:type="Coalesce">
                  <operand localId="737" locator="115:27-115:51" path="value" xsi:type="Property">
                     <source localId="736" locator="115:27-115:45" path="frequencyMax" xsi:type="Property">
                        <source localId="735" locator="115:27-115:32" name="repeat" xsi:type="QueryLetRef"/>
                     </source>
                  </operand>
                  <operand localId="740" locator="115:54-115:75" path="value" xsi:type="Property">
                     <source localId="739" locator="115:54-115:69" path="frequency" xsi:type="Property">
                        <source localId="738" locator="115:54-115:59" name="repeat" xsi:type="QueryLetRef"/>
                     </source>
                  </operand>
               </expression>
            </let>
            <let localId="744" locator="116:7-116:91" identifier="period">
               <expression localId="745" locator="116:15-116:91" classType="t:Quantity" xsi:type="Instance">
                  <element name="value">
                     <value localId="749" locator="116:40-116:58" path="value" xsi:type="Property">
                        <source localId="748" locator="116:40-116:52" path="period" xsi:type="Property">
                           <source localId="747" locator="116:40-116:45" name="repeat" xsi:type="QueryLetRef"/>
                        </source>
                     </value>
                  </element>
                  <element name="unit">
                     <value localId="752" locator="116:67-116:89" path="value" xsi:type="Property">
                        <source localId="751" locator="116:67-116:83" path="periodUnit" xsi:type="Property">
                           <source localId="750" locator="116:67-116:72" name="repeat" xsi:type="QueryLetRef"/>
                        </source>
                     </value>
                  </element>
               </expression>
            </let>
            <let localId="753" locator="117:7-126:9" identifier="doseDescription">
               <expression localId="850" locator="118:9-126:9" xsi:type="Coalesce">
                  <signature localId="851" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="852" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="754" locator="120:11-124:76" xsi:type="If">
                     <condition localId="755" locator="120:14-120:64" xsi:type="Is">
                        <operand localId="763" locator="120:14-120:50" path="dose" xsi:type="Property">
                           <source localId="756" locator="120:14-120:45" xsi:type="Indexer">
                              <signature localId="760" xsi:type="ListTypeSpecifier">
                                 <elementType localId="761" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <signature localId="762" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="758" locator="120:14-120:42" path="doseAndRate" xsi:type="Property">
                                 <source localId="757" locator="120:14-120:30" name="dosageInstruction" xsi:type="QueryLetRef"/>
                              </operand>
                              <operand localId="759" locator="120:44" valueType="t:Integer" value="0" xsi:type="Literal"/>
                           </source>
                        </operand>
                        <isTypeSpecifier localId="764" locator="120:55-120:64" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </condition>
                     <then localId="829" locator="121:18-123:81" xsi:type="Concatenate">
                        <operand localId="815" locator="121:18-122:98" xsi:type="Concatenate">
                           <operand localId="797" locator="121:18-122:31" xsi:type="Concatenate">
                              <operand localId="792" locator="121:18-121:80" xsi:type="ToString">
                                 <signature localId="793" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="780" locator="121:27-121:79" name="ToQuantity" xsi:type="FunctionRef">
                                    <operand localId="776" locator="121:38-121:78" path="low" xsi:type="Property">
                                       <source localId="775" locator="121:38-121:74" path="dose" xsi:type="Property">
                                          <source localId="768" locator="121:38-121:69" xsi:type="Indexer">
                                             <signature localId="772" xsi:type="ListTypeSpecifier">
                                                <elementType localId="773" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                             </signature>
                                             <signature localId="774" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="770" locator="121:38-121:66" path="doseAndRate" xsi:type="Property">
                                                <source localId="769" locator="121:38-121:54" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                             </operand>
                                             <operand localId="771" locator="121:68" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                          </source>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="794" locator="122:29-122:31" valueType="t:String" value="-" xsi:type="Literal"/>
                           </operand>
                           <operand localId="811" locator="122:35-122:98" xsi:type="ToString">
                              <signature localId="812" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="807" locator="122:44-122:97" name="ToQuantity" xsi:type="FunctionRef">
                                 <operand localId="806" locator="122:55-122:96" path="high" xsi:type="Property">
                                    <source localId="805" locator="122:55-122:91" path="dose" xsi:type="Property">
                                       <source localId="798" locator="122:55-122:86" xsi:type="Indexer">
                                          <signature localId="802" xsi:type="ListTypeSpecifier">
                                             <elementType localId="803" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                          </signature>
                                          <signature localId="804" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="800" locator="122:55-122:83" path="doseAndRate" xsi:type="Property">
                                             <source localId="799" locator="122:55-122:71" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                          </operand>
                                          <operand localId="801" locator="122:85" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                       </source>
                                    </source>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="826" locator="123:29-123:81" path="value" xsi:type="Property">
                           <source localId="825" locator="123:29-123:75" path="unit" xsi:type="Property">
                              <source localId="824" locator="123:29-123:70" path="high" xsi:type="Property">
                                 <source localId="823" locator="123:29-123:65" path="dose" xsi:type="Property">
                                    <source localId="816" locator="123:29-123:60" xsi:type="Indexer">
                                       <signature localId="820" xsi:type="ListTypeSpecifier">
                                          <elementType localId="821" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                       </signature>
                                       <signature localId="822" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="818" locator="123:29-123:57" path="doseAndRate" xsi:type="Property">
                                          <source localId="817" locator="123:29-123:45" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                       </operand>
                                       <operand localId="819" locator="123:59" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                    </source>
                                 </source>
                              </source>
                           </source>
                        </operand>
                     </then>
                     <else localId="843" locator="124:18-124:76" xsi:type="ToString">
                        <signature localId="844" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="838" locator="124:27-124:75" name="ToQuantity" xsi:type="FunctionRef">
                           <operand localId="839" asType="fhir:Quantity" xsi:type="As">
                              <operand localId="837" locator="124:38-124:74" path="dose" xsi:type="Property">
                                 <source localId="830" locator="124:38-124:69" xsi:type="Indexer">
                                    <signature localId="834" xsi:type="ListTypeSpecifier">
                                       <elementType localId="835" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                    </signature>
                                    <signature localId="836" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="832" locator="124:38-124:66" path="doseAndRate" xsi:type="Property">
                                       <source localId="831" locator="124:38-124:54" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                    </operand>
                                    <operand localId="833" locator="124:68" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                        </operand>
                     </else>
                  </operand>
                  <operand localId="845" locator="125:13-125:14" valueType="t:String" value="" xsi:type="Literal"/>
               </expression>
            </let>
            <let localId="853" locator="127:7-132:11" identifier="frequencyDescription">
               <expression localId="890" locator="128:9-132:11" xsi:type="Concatenate">
                  <operand localId="863" locator="128:9-128:65" xsi:type="ToString">
                     <signature localId="864" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="859" locator="128:18-128:64" path="value" xsi:type="Property">
                        <source localId="858" locator="128:18-128:58" path="frequency" xsi:type="Property">
                           <source localId="857" locator="128:18-128:48" path="repeat" xsi:type="Property">
                              <source localId="856" locator="128:18-128:41" path="timing" xsi:type="Property">
                                 <source localId="855" locator="128:18-128:34" name="dosageInstruction" xsi:type="QueryLetRef"/>
                              </source>
                           </source>
                        </source>
                     </operand>
                  </operand>
                  <operand localId="885" locator="129:11-132:11" xsi:type="Coalesce">
                     <signature localId="886" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="887" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="879" locator="130:13-130:78" xsi:type="Concatenate">
                        <operand localId="866" locator="130:13-130:15" valueType="t:String" value="-" xsi:type="Literal"/>
                        <operand localId="875" locator="130:19-130:78" xsi:type="ToString">
                           <signature localId="876" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="871" locator="130:28-130:77" path="value" xsi:type="Property">
                              <source localId="870" locator="130:28-130:71" path="frequencyMax" xsi:type="Property">
                                 <source localId="869" locator="130:28-130:58" path="repeat" xsi:type="Property">
                                    <source localId="868" locator="130:28-130:51" path="timing" xsi:type="Property">
                                       <source localId="867" locator="130:28-130:44" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                    </source>
                                 </source>
                              </source>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="880" locator="131:13-131:14" valueType="t:String" value="" xsi:type="Literal"/>
                  </operand>
               </expression>
            </let>
            <return localId="891" locator="133:5-149:5">
               <expression localId="892" locator="133:12-149:5" xsi:type="Tuple">
                  <element name="rxNormCode">
                     <value localId="893" locator="134:19-134:28" name="rxNormCode" xsi:type="QueryLetRef"/>
                  </element>
                  <element name="isDraft">
                     <value localId="894" locator="135:16-135:39" xsi:type="Equal">
                        <signature localId="899" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="900" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="897" locator="135:16-135:29" path="value" xsi:type="Property">
                           <source localId="896" locator="135:16-135:23" path="status" scope="O" xsi:type="Property"/>
                        </operand>
                        <operand localId="898" locator="135:33-135:39" valueType="t:String" value="draft" xsi:type="Literal"/>
                     </value>
                  </element>
                  <element name="isPRN">
                     <value localId="903" locator="137:14-137:45" path="value" xsi:type="Property">
                        <source localId="902" locator="137:14-137:39" path="asNeeded" xsi:type="Property">
                           <source localId="901" locator="137:14-137:30" name="dosageInstruction" xsi:type="QueryLetRef"/>
                        </source>
                     </value>
                  </element>
                  <element name="prescription">
                     <value localId="904" locator="139:9-143:138" xsi:type="If">
                        <condition localId="908" locator="139:12-139:45" xsi:type="Not">
                           <operand localId="907" locator="139:12-139:45" xsi:type="IsNull">
                              <operand localId="906" locator="139:12-139:33" path="text" xsi:type="Property">
                                 <source localId="905" locator="139:12-139:28" name="dosageInstruction" xsi:type="QueryLetRef"/>
                              </operand>
                           </operand>
                        </condition>
                        <then localId="921" locator="140:11-140:61" xsi:type="Concatenate">
                           <operand localId="915" locator="140:11-140:30" xsi:type="Concatenate">
                              <operand localId="911" locator="140:11-140:24" name="medicationName" xsi:type="QueryLetRef"/>
                              <operand localId="912" locator="140:28-140:30" valueType="t:String" value=" " xsi:type="Literal"/>
                           </operand>
                           <operand localId="918" locator="140:34-140:61" path="value" xsi:type="Property">
                              <source localId="917" locator="140:34-140:55" path="text" xsi:type="Property">
                                 <source localId="916" locator="140:34-140:50" name="dosageInstruction" xsi:type="QueryLetRef"/>
                              </source>
                           </operand>
                        </then>
                        <else localId="952" locator="143:11-143:138" xsi:type="Concatenate">
                           <operand localId="943" locator="143:11-143:78" xsi:type="Concatenate">
                              <operand localId="939" locator="143:11-143:55" xsi:type="Concatenate">
                                 <operand localId="935" locator="143:11-143:48" xsi:type="Concatenate">
                                    <operand localId="931" locator="143:11-143:30" xsi:type="Concatenate">
                                       <operand localId="927" locator="143:11-143:24" name="medicationName" xsi:type="QueryLetRef"/>
                                       <operand localId="928" locator="143:28-143:30" valueType="t:String" value=" " xsi:type="Literal"/>
                                    </operand>
                                    <operand localId="932" locator="143:34-143:48" name="doseDescription" xsi:type="QueryLetRef"/>
                                 </operand>
                                 <operand localId="936" locator="143:52-143:55" valueType="t:String" value=" q" xsi:type="Literal"/>
                              </operand>
                              <operand localId="940" locator="143:59-143:78" name="frequencyDescription" xsi:type="QueryLetRef"/>
                           </operand>
                           <operand localId="944" locator="143:82-143:138" xsi:type="If">
                              <condition localId="947" locator="143:86-143:117" path="value" xsi:type="Property">
                                 <source localId="946" locator="143:86-143:111" path="asNeeded" xsi:type="Property">
                                    <source localId="945" locator="143:86-143:102" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                 </source>
                              </condition>
                              <then localId="948" locator="143:124-143:129" valueType="t:String" value=" PRN" xsi:type="Literal"/>
                              <else localId="949" locator="143:136-143:137" valueType="t:String" value="" xsi:type="Literal"/>
                           </operand>
                        </else>
                     </value>
                  </element>
                  <element name="dose">
                     <value localId="953" locator="145:13-147:66" xsi:type="If">
                        <condition localId="954" locator="145:16-145:66" xsi:type="Is">
                           <operand localId="962" locator="145:16-145:52" path="dose" xsi:type="Property">
                              <source localId="955" locator="145:16-145:47" xsi:type="Indexer">
                                 <signature localId="959" xsi:type="ListTypeSpecifier">
                                    <elementType localId="960" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <signature localId="961" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="957" locator="145:16-145:44" path="doseAndRate" xsi:type="Property">
                                    <source localId="956" locator="145:16-145:32" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                 </operand>
                                 <operand localId="958" locator="145:46" valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </source>
                           </operand>
                           <isTypeSpecifier localId="963" locator="145:57-145:66" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                        </condition>
                        <then localId="973" locator="146:18-146:71" name="ToQuantity" xsi:type="FunctionRef">
                           <operand localId="972" locator="146:29-146:70" path="high" xsi:type="Property">
                              <source localId="971" locator="146:29-146:65" path="dose" xsi:type="Property">
                                 <source localId="964" locator="146:29-146:60" xsi:type="Indexer">
                                    <signature localId="968" xsi:type="ListTypeSpecifier">
                                       <elementType localId="969" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                    </signature>
                                    <signature localId="970" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="966" locator="146:29-146:57" path="doseAndRate" xsi:type="Property">
                                       <source localId="965" locator="146:29-146:45" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                    </operand>
                                    <operand localId="967" locator="146:59" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                 </source>
                              </source>
                           </operand>
                        </then>
                        <else localId="982" locator="147:18-147:66" name="ToQuantity" xsi:type="FunctionRef">
                           <operand localId="983" asType="fhir:Quantity" xsi:type="As">
                              <operand localId="981" locator="147:29-147:65" path="dose" xsi:type="Property">
                                 <source localId="974" locator="147:29-147:60" xsi:type="Indexer">
                                    <signature localId="978" xsi:type="ListTypeSpecifier">
                                       <elementType localId="979" name="fhir:Dosage.DoseAndRate" xsi:type="NamedTypeSpecifier"/>
                                    </signature>
                                    <signature localId="980" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="976" locator="147:29-147:57" path="doseAndRate" xsi:type="Property">
                                       <source localId="975" locator="147:29-147:45" name="dosageInstruction" xsi:type="QueryLetRef"/>
                                    </operand>
                                    <operand localId="977" locator="147:59" valueType="t:Integer" value="0" xsi:type="Literal"/>
                                 </source>
                              </operand>
                           </operand>
                        </else>
                     </value>
                  </element>
                  <element name="dosesPerDay">
                     <value localId="993" locator="148:20-148:70" xsi:type="Coalesce">
                        <signature localId="994" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="995" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="987" locator="148:29-148:64" name="ToDaily" libraryName="OMTKLogic" xsi:type="FunctionRef">
                           <operand localId="985" locator="148:47-148:55" name="frequency" xsi:type="QueryLetRef"/>
                           <operand localId="986" locator="148:58-148:63" name="period" xsi:type="QueryLetRef"/>
                        </operand>
                        <operand localId="988" locator="148:67-148:69" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                     </value>
                  </element>
               </expression>
            </return>
         </expression>
         <operand localId="705" name="Orders">
            <operandTypeSpecifier localId="703" locator="106:38-106:60" xsi:type="ListTypeSpecifier">
               <elementType localId="704" locator="106:43-106:59" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="777" locator="246:1-247:76" name="ToQuantity" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="777">
               <a:s>define function ToQuantity(quantity FHIR.Quantity):
  </a:s>
               <a:s r="1835">
                  <a:s r="1835">
                     <a:s>System.Quantity { </a:s>
                     <a:s>
                        <a:s>value: </a:s>
                        <a:s r="1839">
                           <a:s r="1838">
                              <a:s r="1837">
                                 <a:s>quantity</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1838">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1839">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s>
                        <a:s>unit: </a:s>
                        <a:s r="1842">
                           <a:s r="1841">
                              <a:s r="1840">
                                 <a:s>quantity</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1841">
                                 <a:s>unit</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1842">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s> }</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1835" locator="247:3-247:76" classType="t:Quantity" xsi:type="Instance">
            <element name="value">
               <value localId="1839" locator="247:28-247:47" path="value" xsi:type="Property">
                  <source localId="1838" locator="247:28-247:41" path="value" xsi:type="Property">
                     <source localId="1837" locator="247:28-247:35" name="quantity" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
            <element name="unit">
               <value localId="1842" locator="247:56-247:74" path="value" xsi:type="Property">
                  <source localId="1841" locator="247:56-247:68" path="unit" xsi:type="Property">
                     <source localId="1840" locator="247:56-247:63" name="quantity" xsi:type="OperandRef"/>
                  </source>
               </value>
            </element>
         </expression>
         <operand localId="779" name="quantity">
            <operandTypeSpecifier localId="778" locator="246:37-246:49" name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="997" locator="151:1-162:5" name="MME" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="997">
               <a:s>define function MME(prescriptions List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1034">
                  <a:s r="1034">
                     <a:s>
                        <a:s r="1001">
                           <a:s r="1003">
                              <a:s>(</a:s>
                              <a:s r="1003">
                                 <a:s>Prescriptions(</a:s>
                                 <a:s r="1002">
                                    <a:s>prescriptions</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> P</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="1004">
                           <a:s>mme: </a:s>
                           <a:s r="1017">
                              <a:s>SingletonFrom(</a:s>
                              <a:s r="1014">
                                 <a:s r="1005">
                                    <a:s>OMTKLogic</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1014">
                                    <a:s>CalculateMMEs(</a:s>
                                    <a:s r="1006">
                                       <a:s>{ </a:s>
                                       <a:s r="1007">
                                          <a:s>{ </a:s>
                                          <a:s>
                                             <a:s>rxNormCode: </a:s>
                                             <a:s r="1009">
                                                <a:s r="1008">
                                                   <a:s>P</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1009">
                                                   <a:s>rxNormCode</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>, </a:s>
                                          <a:s>
                                             <a:s>doseQuantity: </a:s>
                                             <a:s r="1011">
                                                <a:s r="1010">
                                                   <a:s>P</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1011">
                                                   <a:s>dose</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>, </a:s>
                                          <a:s>
                                             <a:s>dosesPerDay: </a:s>
                                             <a:s r="1013">
                                                <a:s r="1012">
                                                   <a:s>P</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1013">
                                                   <a:s>dosesPerDay</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> }</a:s>
                                       </a:s>
                                       <a:s> }</a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1018">
                        <a:s>return </a:s>
                        <a:s r="1019">
                           <a:s>{
      </a:s>
                           <a:s>
                              <a:s>rxNormCode: </a:s>
                              <a:s r="1021">
                                 <a:s r="1020">
                                    <a:s>P</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1021">
                                    <a:s>rxNormCode</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>isDraft: </a:s>
                              <a:s r="1023">
                                 <a:s r="1022">
                                    <a:s>P</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1023">
                                    <a:s>isDraft</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>isPRN: </a:s>
                              <a:s r="1025">
                                 <a:s r="1024">
                                    <a:s>P</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1025">
                                    <a:s>isPRN</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>prescription: </a:s>
                              <a:s r="1027">
                                 <a:s r="1026">
                                    <a:s>P</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1027">
                                    <a:s>prescription</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>dailyDose: </a:s>
                              <a:s r="1029">
                                 <a:s r="1028">
                                    <a:s>mme</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1029">
                                    <a:s>dailyDoseDescription</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>conversionFactor: </a:s>
                              <a:s r="1031">
                                 <a:s r="1030">
                                    <a:s>mme</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1031">
                                    <a:s>conversionFactor</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
      </a:s>
                           <a:s>
                              <a:s>mme: </a:s>
                              <a:s r="1033">
                                 <a:s r="1032">
                                    <a:s>mme</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1033">
                                    <a:s>mme</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    }</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1034" locator="152:3-162:5" xsi:type="Query">
            <source localId="1001" locator="152:3-152:34" alias="P">
               <expression localId="1003" locator="152:3-152:32" name="Prescriptions" xsi:type="FunctionRef">
                  <operand localId="1002" locator="152:18-152:30" name="prescriptions" xsi:type="OperandRef"/>
               </expression>
            </source>
            <let localId="1004" locator="153:9-153:135" identifier="mme">
               <expression localId="1017" locator="153:14-153:135" xsi:type="SingletonFrom">
                  <operand localId="1014" locator="153:28-153:134" name="CalculateMMEs" libraryName="OMTKLogic" xsi:type="FunctionRef">
                     <operand localId="1006" locator="153:52-153:133" xsi:type="List">
                        <element localId="1007" locator="153:54-153:131" xsi:type="Tuple">
                           <element name="rxNormCode">
                              <value localId="1009" locator="153:68-153:79" path="rxNormCode" scope="P" xsi:type="Property"/>
                           </element>
                           <element name="doseQuantity">
                              <value localId="1011" locator="153:96-153:101" path="dose" scope="P" xsi:type="Property"/>
                           </element>
                           <element name="dosesPerDay">
                              <value localId="1013" locator="153:117-153:129" path="dosesPerDay" scope="P" xsi:type="Property"/>
                           </element>
                        </element>
                     </operand>
                  </operand>
               </expression>
            </let>
            <return localId="1018" locator="154:5-162:5">
               <expression localId="1019" locator="154:12-162:5" xsi:type="Tuple">
                  <element name="rxNormCode">
                     <value localId="1021" locator="155:19-155:30" path="rxNormCode" scope="P" xsi:type="Property"/>
                  </element>
                  <element name="isDraft">
                     <value localId="1023" locator="156:16-156:24" path="isDraft" scope="P" xsi:type="Property"/>
                  </element>
                  <element name="isPRN">
                     <value localId="1025" locator="157:14-157:20" path="isPRN" scope="P" xsi:type="Property"/>
                  </element>
                  <element name="prescription">
                     <value localId="1027" locator="158:21-158:34" path="prescription" scope="P" xsi:type="Property"/>
                  </element>
                  <element name="dailyDose">
                     <value localId="1029" locator="159:18-159:41" path="dailyDoseDescription" xsi:type="Property">
                        <source localId="1028" locator="159:18-159:20" name="mme" xsi:type="QueryLetRef"/>
                     </value>
                  </element>
                  <element name="conversionFactor">
                     <value localId="1031" locator="160:25-160:44" path="conversionFactor" xsi:type="Property">
                        <source localId="1030" locator="160:25-160:27" name="mme" xsi:type="QueryLetRef"/>
                     </value>
                  </element>
                  <element name="mme">
                     <value localId="1033" locator="161:12-161:18" path="mme" xsi:type="Property">
                        <source localId="1032" locator="161:12-161:14" name="mme" xsi:type="QueryLetRef"/>
                     </value>
                  </element>
               </expression>
            </return>
         </expression>
         <operand localId="1000" name="prescriptions">
            <operandTypeSpecifier localId="998" locator="151:35-151:57" xsi:type="ListTypeSpecifier">
               <elementType localId="999" locator="151:40-151:56" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1035" locator="164:1-168:3" name="TotalMME" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1035">
               <a:s>define function TotalMME(prescriptions List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1039">
                  <a:s r="1039">
                     <a:s>System.Quantity {
    </a:s>
                     <a:s>
                        <a:s>value: </a:s>
                        <a:s r="1053">
                           <a:s>Sum(</a:s>
                           <a:s r="1048">
                              <a:s>
                                 <a:s r="1041">
                                    <a:s r="1043">
                                       <a:s>(</a:s>
                                       <a:s r="1043">
                                          <a:s>MME(</a:s>
                                          <a:s r="1042">
                                             <a:s>prescriptions</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s> M</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> </a:s>
                              <a:s r="1044">
                                 <a:s>return </a:s>
                                 <a:s r="1047">
                                    <a:s r="1046">
                                       <a:s r="1045">
                                          <a:s>M</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1046">
                                          <a:s>mme</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1047">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s>
                        <a:s>unit: </a:s>
                        <a:s r="1056">
                           <a:s>'mg/d'</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  }</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1039" locator="165:3-168:3" classType="t:Quantity" xsi:type="Instance">
            <element name="value">
               <value localId="1053" locator="166:12-166:57" xsi:type="Sum">
                  <signature localId="1054" xsi:type="ListTypeSpecifier">
                     <elementType localId="1055" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <source localId="1048" locator="166:16-166:56" xsi:type="Query">
                     <source localId="1041" locator="166:16-166:37" alias="M">
                        <expression localId="1043" locator="166:16-166:35" name="MME" xsi:type="FunctionRef">
                           <operand localId="1042" locator="166:21-166:33" name="prescriptions" xsi:type="OperandRef"/>
                        </expression>
                     </source>
                     <return localId="1044" locator="166:39-166:56">
                        <expression localId="1047" locator="166:46-166:56" path="value" xsi:type="Property">
                           <source localId="1046" locator="166:46-166:50" path="mme" scope="M" xsi:type="Property"/>
                        </expression>
                     </return>
                  </source>
               </value>
            </element>
            <element name="unit">
               <value localId="1056" locator="167:11-167:16" valueType="t:String" value="mg/d" xsi:type="Literal"/>
            </element>
         </expression>
         <operand localId="1038" name="prescriptions">
            <operandTypeSpecifier localId="1036" locator="164:40-164:62" xsi:type="ListTypeSpecifier">
               <elementType localId="1037" locator="164:45-164:61" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1057" locator="170:1-190:118" name="ProbableDaysInRange" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1057">
               <a:s>define function ProbableDaysInRange(Orders List&lt;MedicationRequest>, daysPast Integer, numDaysInDaysPast Integer):
  </a:s>
               <a:s r="1488">
                  <a:s r="1488">
                     <a:s>
                        <a:s r="1065">
                           <a:s r="1066">
                              <a:s>
                                 <a:s>Orders</a:s>
                              </a:s>
                           </a:s>
                           <a:s> orders</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let
      </a:s>
                        <a:s r="1067">
                           <a:s>frequency: </a:s>
                           <a:s r="1078">
                              <a:s r="1077">
                                 <a:s r="1076">
                                    <a:s r="1075">
                                       <a:s r="1068">
                                          <a:s r="1070">
                                             <a:s r="1069">
                                                <a:s>orders</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1070">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="1071">[0]</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1075">
                                          <a:s>timing</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1076">
                                       <a:s>repeat</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1077">
                                    <a:s>frequency</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1078">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1079">
                           <a:s>period: </a:s>
                           <a:s r="1090">
                              <a:s r="1089">
                                 <a:s r="1088">
                                    <a:s r="1087">
                                       <a:s r="1080">
                                          <a:s r="1082">
                                             <a:s r="1081">
                                                <a:s>orders</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1082">
                                                <a:s>dosageInstruction</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="1083">[0]</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1087">
                                          <a:s>timing</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1088">
                                       <a:s>repeat</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1089">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1090">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1091">
                           <a:s>periodDays: </a:s>
                           <a:s r="1106">
                              <a:s>GetPeriodDays(</a:s>
                              <a:s r="1102">
                                 <a:s r="1101">
                                    <a:s r="1100">
                                       <a:s r="1099">
                                          <a:s r="1092">
                                             <a:s r="1094">
                                                <a:s r="1093">
                                                   <a:s>orders</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1094">
                                                   <a:s>dosageInstruction</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="1095">[0]</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1099">
                                             <a:s>timing</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1100">
                                          <a:s>repeat</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1101">
                                       <a:s>periodUnit</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1102">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1191">
                           <a:s>dosesPerDay:
        </a:s>
                           <a:s r="1192">
                              <a:s>if </a:s>
                              <a:s r="1193">
                                 <a:s r="1194">
                                    <a:s>(</a:s>
                                    <a:s r="1194">
                                       <a:s r="1195">
                                          <a:s>frequency</a:s>
                                       </a:s>
                                       <a:s> / </a:s>
                                       <a:s r="1196">
                                          <a:s>(</a:s>
                                          <a:s r="1196">
                                             <a:s r="1197">
                                                <a:s>period</a:s>
                                             </a:s>
                                             <a:s> * </a:s>
                                             <a:s r="1198">
                                                <a:s>periodDays</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s r="1206"> >= 1.0</a:s>
                              </a:s>
                              <a:s r="1209">
        then 1.0
        else </a:s>
                              <a:s r="1210">
                                 <a:s r="1211">
                                    <a:s>frequency</a:s>
                                 </a:s>
                                 <a:s> / </a:s>
                                 <a:s r="1212">
                                    <a:s>(</a:s>
                                    <a:s r="1212">
                                       <a:s r="1213">
                                          <a:s>period</a:s>
                                       </a:s>
                                       <a:s> * </a:s>
                                       <a:s r="1214">
                                          <a:s>periodDays</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1222">
                           <a:s>repeat: </a:s>
                           <a:s r="1226">
                              <a:s r="1225">
                                 <a:s r="1224">
                                    <a:s r="1223">
                                       <a:s>orders</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1224">
                                       <a:s>dispenseRequest</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1225">
                                    <a:s>numberOfRepeatsAllowed</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1226">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1227">
                           <a:s>supplyDuration: </a:s>
                           <a:s r="1234">
                              <a:s>GetDurationInDays(</a:s>
                              <a:s r="1230">
                                 <a:s r="1229">
                                    <a:s r="1228">
                                       <a:s>orders</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1229">
                                       <a:s>dispenseRequest</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1230">
                                    <a:s>expectedSupplyDuration</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1387">
                           <a:s>validityPeriod: </a:s>
                           <a:s r="1388">
                              <a:s>days between </a:s>
                              <a:s r="1393">
                                 <a:s r="1392">
                                    <a:s r="1391">
                                       <a:s r="1390">
                                          <a:s r="1389">
                                             <a:s>orders</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1390">
                                             <a:s>dispenseRequest</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1391">
                                          <a:s>validityPeriod</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1392">
                                       <a:s>&quot;start&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1393">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> and </a:s>
                              <a:s r="1396">
                                 <a:s>Today()</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s r="1402">
                           <a:s>endDifference:
        </a:s>
                           <a:s r="1403">
                              <a:s>if </a:s>
                              <a:s r="1404">
                                 <a:s r="1409">
                                    <a:s r="1408">
                                       <a:s r="1407">
                                          <a:s r="1406">
                                             <a:s r="1405">
                                                <a:s>orders</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1406">
                                                <a:s>dispenseRequest</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1407">
                                             <a:s>validityPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1408">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1409">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> &lt; </a:s>
                                 <a:s r="1412">
                                    <a:s>Today()</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
        then </a:s>
                              <a:s r="1418">
                                 <a:s>days between </a:s>
                                 <a:s r="1423">
                                    <a:s r="1422">
                                       <a:s r="1421">
                                          <a:s r="1420">
                                             <a:s r="1419">
                                                <a:s>orders</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1420">
                                                <a:s>dispenseRequest</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1421">
                                             <a:s>validityPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1422">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1423">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="1426">
                                    <a:s>Today()</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="1432">
        else 0</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1433">
                        <a:s>return
      </a:s>
                        <a:s r="1434">
                           <a:s>if </a:s>
                           <a:s r="1435">
                              <a:s r="1436">
                                 <a:s>(</a:s>
                                 <a:s r="1436">
                                    <a:s r="1437">
                                       <a:s>repeat</a:s>
                                    </a:s>
                                    <a:s> * </a:s>
                                    <a:s r="1438">
                                       <a:s>supplyDuration</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> &lt; </a:s>
                              <a:s r="1444">
                                 <a:s>numDaysInDaysPast</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="1450"> then false
      else
        </a:s>
                           <a:s r="1451">
                              <a:s r="1452">
                                 <a:s>(</a:s>
                                 <a:s r="1452">
                                    <a:s r="1453">
                                       <a:s r="1454">
                                          <a:s>dosesPerDay</a:s>
                                       </a:s>
                                       <a:s> * </a:s>
                                       <a:s r="1455">
                                          <a:s>(</a:s>
                                          <a:s r="1455">
                                             <a:s r="1456">
                                                <a:s>(</a:s>
                                                <a:s r="1456">
                                                   <a:s r="1457">
                                                      <a:s>repeat</a:s>
                                                   </a:s>
                                                   <a:s> * </a:s>
                                                   <a:s r="1458">
                                                      <a:s>supplyDuration</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> / </a:s>
                                             <a:s r="1464">
                                                <a:s>validityPeriod</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> * </a:s>
                                    <a:s r="1472">
                                       <a:s>(</a:s>
                                       <a:s r="1472">
                                          <a:s r="1473">
                                             <a:s>daysPast</a:s>
                                          </a:s>
                                          <a:s> - </a:s>
                                          <a:s r="1474">
                                             <a:s>endDifference</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> >= </a:s>
                              <a:s r="1482">
                                 <a:s>numDaysInDaysPast</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1488" locator="171:3-190:118" xsi:type="Query">
            <source localId="1065" locator="171:3-171:15" alias="orders">
               <expression localId="1066" locator="171:3-171:8" name="Orders" xsi:type="OperandRef"/>
            </source>
            <let localId="1067" locator="173:7-173:74" identifier="frequency">
               <expression localId="1078" locator="173:18-173:74" path="value" xsi:type="Property">
                  <source localId="1077" locator="173:18-173:68" path="frequency" xsi:type="Property">
                     <source localId="1076" locator="173:18-173:58" path="repeat" xsi:type="Property">
                        <source localId="1075" locator="173:18-173:51" path="timing" xsi:type="Property">
                           <source localId="1068" locator="173:18-173:44" xsi:type="Indexer">
                              <signature localId="1072" xsi:type="ListTypeSpecifier">
                                 <elementType localId="1073" name="fhir:Dosage" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <signature localId="1074" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1070" locator="173:18-173:41" path="dosageInstruction" scope="orders" xsi:type="Property"/>
                              <operand localId="1071" locator="173:43" valueType="t:Integer" value="0" xsi:type="Literal"/>
                           </source>
                        </source>
                     </source>
                  </source>
               </expression>
            </let>
            <let localId="1079" locator="174:7-174:68" identifier="period">
               <expression localId="1090" locator="174:15-174:68" path="value" xsi:type="Property">
                  <source localId="1089" locator="174:15-174:62" path="period" xsi:type="Property">
                     <source localId="1088" locator="174:15-174:55" path="repeat" xsi:type="Property">
                        <source localId="1087" locator="174:15-174:48" path="timing" xsi:type="Property">
                           <source localId="1080" locator="174:15-174:41" xsi:type="Indexer">
                              <signature localId="1084" xsi:type="ListTypeSpecifier">
                                 <elementType localId="1085" name="fhir:Dosage" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <signature localId="1086" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1082" locator="174:15-174:38" path="dosageInstruction" scope="orders" xsi:type="Property"/>
                              <operand localId="1083" locator="174:40" valueType="t:Integer" value="0" xsi:type="Literal"/>
                           </source>
                        </source>
                     </source>
                  </source>
               </expression>
            </let>
            <let localId="1091" locator="175:7-175:91" identifier="periodDays">
               <expression localId="1106" locator="175:19-175:91" name="GetPeriodDays" xsi:type="FunctionRef">
                  <operand localId="1102" locator="175:33-175:90" path="value" xsi:type="Property">
                     <source localId="1101" locator="175:33-175:84" path="periodUnit" xsi:type="Property">
                        <source localId="1100" locator="175:33-175:73" path="repeat" xsi:type="Property">
                           <source localId="1099" locator="175:33-175:66" path="timing" xsi:type="Property">
                              <source localId="1092" locator="175:33-175:59" xsi:type="Indexer">
                                 <signature localId="1096" xsi:type="ListTypeSpecifier">
                                    <elementType localId="1097" name="fhir:Dosage" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <signature localId="1098" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="1094" locator="175:33-175:56" path="dosageInstruction" scope="orders" xsi:type="Property"/>
                                 <operand localId="1095" locator="175:58" valueType="t:Integer" value="0" xsi:type="Literal"/>
                              </source>
                           </source>
                        </source>
                     </source>
                  </operand>
               </expression>
            </let>
            <let localId="1191" locator="176:7-179:46" identifier="dosesPerDay">
               <expression localId="1192" locator="177:9-179:46" xsi:type="If">
                  <condition localId="1193" locator="177:12-177:53" xsi:type="GreaterOrEqual">
                     <signature localId="1207" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1208" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1194" locator="177:12-177:46" xsi:type="Divide">
                        <signature localId="1204" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1205" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1202" xsi:type="ToDecimal">
                           <signature localId="1203" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1195" locator="177:13-177:21" name="frequency" xsi:type="QueryLetRef"/>
                        </operand>
                        <operand localId="1196" locator="177:25-177:45" xsi:type="Multiply">
                           <signature localId="1199" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1200" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1197" locator="177:26-177:31" name="period" xsi:type="QueryLetRef"/>
                           <operand localId="1198" locator="177:35-177:44" name="periodDays" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                     <operand localId="1206" locator="177:51-177:53" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                  </condition>
                  <then localId="1209" locator="178:14-178:16" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                  <else localId="1210" locator="179:14-179:46" xsi:type="Divide">
                     <signature localId="1220" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1221" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1218" xsi:type="ToDecimal">
                        <signature localId="1219" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1211" locator="179:14-179:22" name="frequency" xsi:type="QueryLetRef"/>
                     </operand>
                     <operand localId="1212" locator="179:26-179:46" xsi:type="Multiply">
                        <signature localId="1215" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1216" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1213" locator="179:27-179:32" name="period" xsi:type="QueryLetRef"/>
                        <operand localId="1214" locator="179:36-179:45" name="periodDays" xsi:type="QueryLetRef"/>
                     </operand>
                  </else>
               </expression>
            </let>
            <let localId="1222" locator="180:7-180:65" identifier="repeat">
               <expression localId="1226" locator="180:15-180:65" path="value" xsi:type="Property">
                  <source localId="1225" locator="180:15-180:59" path="numberOfRepeatsAllowed" xsi:type="Property">
                     <source localId="1224" locator="180:15-180:36" path="dispenseRequest" scope="orders" xsi:type="Property"/>
                  </source>
               </expression>
            </let>
            <let localId="1227" locator="181:7-181:86" identifier="supplyDuration">
               <expression localId="1234" locator="181:23-181:86" name="GetDurationInDays" xsi:type="FunctionRef">
                  <operand localId="1230" locator="181:41-181:85" path="expectedSupplyDuration" xsi:type="Property">
                     <source localId="1229" locator="181:41-181:62" path="dispenseRequest" scope="orders" xsi:type="Property"/>
                  </operand>
               </expression>
            </let>
            <let localId="1387" locator="182:7-182:98" identifier="validityPeriod">
               <expression localId="1388" locator="182:23-182:98" precision="Day" xsi:type="DurationBetween">
                  <signature localId="1400" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1401" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1393" locator="182:36-182:86" path="value" xsi:type="Property">
                     <source localId="1392" locator="182:36-182:80" path="start" xsi:type="Property">
                        <source localId="1391" locator="182:36-182:72" path="validityPeriod" xsi:type="Property">
                           <source localId="1390" locator="182:36-182:57" path="dispenseRequest" scope="orders" xsi:type="Property"/>
                        </source>
                     </source>
                  </operand>
                  <operand localId="1398" xsi:type="ToDateTime">
                     <signature localId="1399" name="t:Date" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1396" locator="182:92-182:98" xsi:type="Today"/>
                  </operand>
               </expression>
            </let>
            <let localId="1402" locator="183:7-186:14" identifier="endDifference">
               <expression localId="1403" locator="184:9-186:14" xsi:type="If">
                  <condition localId="1404" locator="184:12-184:70" xsi:type="Less">
                     <signature localId="1416" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1417" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1409" locator="184:12-184:60" path="value" xsi:type="Property">
                        <source localId="1408" locator="184:12-184:54" path="end" xsi:type="Property">
                           <source localId="1407" locator="184:12-184:48" path="validityPeriod" xsi:type="Property">
                              <source localId="1406" locator="184:12-184:33" path="dispenseRequest" scope="orders" xsi:type="Property"/>
                           </source>
                        </source>
                     </operand>
                     <operand localId="1414" xsi:type="ToDateTime">
                        <signature localId="1415" name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1412" locator="184:64-184:70" xsi:type="Today"/>
                     </operand>
                  </condition>
                  <then localId="1418" locator="185:14-185:87" precision="Day" xsi:type="DurationBetween">
                     <signature localId="1430" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1431" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1423" locator="185:27-185:75" path="value" xsi:type="Property">
                        <source localId="1422" locator="185:27-185:69" path="end" xsi:type="Property">
                           <source localId="1421" locator="185:27-185:63" path="validityPeriod" xsi:type="Property">
                              <source localId="1420" locator="185:27-185:48" path="dispenseRequest" scope="orders" xsi:type="Property"/>
                           </source>
                        </source>
                     </operand>
                     <operand localId="1428" xsi:type="ToDateTime">
                        <signature localId="1429" name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1426" locator="185:81-185:87" xsi:type="Today"/>
                     </operand>
                  </then>
                  <else localId="1432" locator="186:14" valueType="t:Integer" value="0" xsi:type="Literal"/>
               </expression>
            </let>
            <return localId="1433" locator="187:5-190:118">
               <expression localId="1434" locator="188:7-190:118" xsi:type="If">
                  <condition localId="1435" locator="188:10-188:54" xsi:type="Less">
                     <signature localId="1448" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1449" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1436" locator="188:10-188:34" xsi:type="Multiply">
                        <signature localId="1442" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1443" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1440" xsi:type="ToDecimal">
                           <signature localId="1441" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1437" locator="188:11-188:16" name="repeat" xsi:type="QueryLetRef"/>
                        </operand>
                        <operand localId="1438" locator="188:20-188:33" name="supplyDuration" xsi:type="QueryLetRef"/>
                     </operand>
                     <operand localId="1446" xsi:type="ToDecimal">
                        <signature localId="1447" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1444" locator="188:38-188:54" name="numDaysInDaysPast" xsi:type="OperandRef"/>
                     </operand>
                  </condition>
                  <then localId="1450" locator="188:61-188:65" valueType="t:Boolean" value="false" xsi:type="Literal"/>
                  <else localId="1451" locator="190:9-190:118" xsi:type="GreaterOrEqual">
                     <signature localId="1486" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1487" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1452" locator="190:9-190:97" xsi:type="Multiply">
                        <signature localId="1480" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1481" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1453" locator="190:10-190:67" xsi:type="Multiply">
                           <signature localId="1470" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1471" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1454" locator="190:10-190:20" name="dosesPerDay" xsi:type="QueryLetRef"/>
                           <operand localId="1455" locator="190:24-190:67" xsi:type="Divide">
                              <signature localId="1468" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="1469" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1456" locator="190:25-190:49" xsi:type="Multiply">
                                 <signature localId="1462" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                                 <signature localId="1463" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="1460" xsi:type="ToDecimal">
                                    <signature localId="1461" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="1457" locator="190:26-190:31" name="repeat" xsi:type="QueryLetRef"/>
                                 </operand>
                                 <operand localId="1458" locator="190:35-190:48" name="supplyDuration" xsi:type="QueryLetRef"/>
                              </operand>
                              <operand localId="1466" xsi:type="ToDecimal">
                                 <signature localId="1467" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="1464" locator="190:53-190:66" name="validityPeriod" xsi:type="QueryLetRef"/>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="1478" xsi:type="ToDecimal">
                           <signature localId="1479" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1472" locator="190:71-190:96" xsi:type="Subtract">
                              <signature localId="1475" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="1476" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1473" locator="190:72-190:79" name="daysPast" xsi:type="OperandRef"/>
                              <operand localId="1474" locator="190:83-190:95" name="endDifference" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="1484" xsi:type="ToDecimal">
                        <signature localId="1485" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1482" locator="190:102-190:118" name="numDaysInDaysPast" xsi:type="OperandRef"/>
                     </operand>
                  </else>
               </expression>
            </return>
         </expression>
         <operand localId="1060" name="Orders">
            <operandTypeSpecifier localId="1058" locator="170:44-170:66" xsi:type="ListTypeSpecifier">
               <elementType localId="1059" locator="170:49-170:65" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="1062" name="daysPast">
            <operandTypeSpecifier localId="1061" locator="170:78-170:84" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="1064" name="numDaysInDaysPast">
            <operandTypeSpecifier localId="1063" locator="170:105-170:111" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1103" locator="192:1-201:5" name="GetPeriodDays" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1103">
               <a:s>define function GetPeriodDays(value System.String):
  </a:s>
               <a:s r="1489">
                  <a:s r="1489">
                     <a:s>case
    </a:s>
                     <a:s r="1490">
                        <a:s>when </a:s>
                        <a:s r="1491">
                           <a:s r="1492">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1493">
                              <a:s>'a'</a:s>
                           </a:s>
                        </a:s>
                        <a:s r="1496"> then 365.0</a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1497">
                        <a:s>when </a:s>
                        <a:s r="1498">
                           <a:s r="1499">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1500">
                              <a:s>'mo'</a:s>
                           </a:s>
                        </a:s>
                        <a:s r="1503"> then 30.0</a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1504">
                        <a:s>when </a:s>
                        <a:s r="1505">
                           <a:s r="1506">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1507">
                              <a:s>'h'</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1510">
                           <a:s r="1511">1.0/24.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1515">
                        <a:s>when </a:s>
                        <a:s r="1516">
                           <a:s r="1517">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1518">
                              <a:s>'min'</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1521">
                           <a:s r="1522">
                              <a:s r="1523">1.0/24.0</a:s>
                           </a:s>
                           <a:s r="1527">*60.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1530">
                        <a:s>when </a:s>
                        <a:s r="1531">
                           <a:s r="1532">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1533">
                              <a:s>'s'</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1536">
                           <a:s r="1537">
                              <a:s r="1538">
                                 <a:s r="1539">1.0/24.0</a:s>
                              </a:s>
                              <a:s r="1543">*60.0</a:s>
                           </a:s>
                           <a:s r="1546">*60.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1549">
                        <a:s>when </a:s>
                        <a:s r="1550">
                           <a:s r="1551">
                              <a:s>value</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1552">
                              <a:s>'ms'</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1555">
                           <a:s r="1556">
                              <a:s r="1557">
                                 <a:s r="1558">
                                    <a:s r="1559">1.0/24.0</a:s>
                                 </a:s>
                                 <a:s r="1563">*60.0</a:s>
                              </a:s>
                              <a:s r="1566">*60.0</a:s>
                           </a:s>
                           <a:s r="1569">*1000.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s r="1572">
    else 1.0
  end</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1489" locator="193:3-201:5" xsi:type="Case">
            <caseItem localId="1490" locator="194:5-194:31">
               <when localId="1491" locator="194:10-194:20" xsi:type="Equal">
                  <signature localId="1494" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1495" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1492" locator="194:10-194:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1493" locator="194:18-194:20" valueType="t:String" value="a" xsi:type="Literal"/>
               </when>
               <then localId="1496" locator="194:27-194:31" valueType="t:Decimal" value="365.0" xsi:type="Literal"/>
            </caseItem>
            <caseItem localId="1497" locator="195:5-195:31">
               <when localId="1498" locator="195:10-195:21" xsi:type="Equal">
                  <signature localId="1501" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1502" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1499" locator="195:10-195:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1500" locator="195:18-195:21" valueType="t:String" value="mo" xsi:type="Literal"/>
               </when>
               <then localId="1503" locator="195:28-195:31" valueType="t:Decimal" value="30.0" xsi:type="Literal"/>
            </caseItem>
            <caseItem localId="1504" locator="196:5-196:34">
               <when localId="1505" locator="196:10-196:20" xsi:type="Equal">
                  <signature localId="1508" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1509" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1506" locator="196:10-196:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1507" locator="196:18-196:20" valueType="t:String" value="h" xsi:type="Literal"/>
               </when>
               <then localId="1510" locator="196:27-196:34" xsi:type="Divide">
                  <signature localId="1513" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1514" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1511" locator="196:27-196:29" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                  <operand localId="1512" locator="196:31-196:34" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1515" locator="197:5-197:41">
               <when localId="1516" locator="197:10-197:22" xsi:type="Equal">
                  <signature localId="1519" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1520" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1517" locator="197:10-197:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1518" locator="197:18-197:22" valueType="t:String" value="min" xsi:type="Literal"/>
               </when>
               <then localId="1521" locator="197:29-197:41" xsi:type="Multiply">
                  <signature localId="1528" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1529" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1522" locator="197:29-197:36" xsi:type="Divide">
                     <signature localId="1525" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1526" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1523" locator="197:29-197:31" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                     <operand localId="1524" locator="197:33-197:36" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1527" locator="197:38-197:41" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1530" locator="198:5-198:44">
               <when localId="1531" locator="198:10-198:20" xsi:type="Equal">
                  <signature localId="1534" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1535" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1532" locator="198:10-198:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1533" locator="198:18-198:20" valueType="t:String" value="s" xsi:type="Literal"/>
               </when>
               <then localId="1536" locator="198:27-198:44" xsi:type="Multiply">
                  <signature localId="1547" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1548" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1537" locator="198:27-198:39" xsi:type="Multiply">
                     <signature localId="1544" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1545" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1538" locator="198:27-198:34" xsi:type="Divide">
                        <signature localId="1541" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1542" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1539" locator="198:27-198:29" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                        <operand localId="1540" locator="198:31-198:34" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
                     </operand>
                     <operand localId="1543" locator="198:36-198:39" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1546" locator="198:41-198:44" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1549" locator="199:5-199:52">
               <when localId="1550" locator="199:10-199:21" xsi:type="Equal">
                  <signature localId="1553" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1554" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1551" locator="199:10-199:14" name="value" xsi:type="OperandRef"/>
                  <operand localId="1552" locator="199:18-199:21" valueType="t:String" value="ms" xsi:type="Literal"/>
               </when>
               <then localId="1555" locator="199:28-199:52" xsi:type="Multiply">
                  <signature localId="1570" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1571" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1556" locator="199:28-199:45" xsi:type="Multiply">
                     <signature localId="1567" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1568" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1557" locator="199:28-199:40" xsi:type="Multiply">
                        <signature localId="1564" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1565" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1558" locator="199:28-199:35" xsi:type="Divide">
                           <signature localId="1561" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1562" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1559" locator="199:28-199:30" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
                           <operand localId="1560" locator="199:32-199:35" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
                        </operand>
                        <operand localId="1563" locator="199:37-199:40" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                     </operand>
                     <operand localId="1566" locator="199:42-199:45" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1569" locator="199:47-199:52" valueType="t:Decimal" value="1000.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <else localId="1572" locator="200:10-200:12" valueType="t:Decimal" value="1.0" xsi:type="Literal"/>
         </expression>
         <operand localId="1105" name="value">
            <operandTypeSpecifier localId="1104" locator="192:37-192:49" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1231" locator="203:3-214:7" name="GetDurationInDays" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1231">
               <a:s>define function GetDurationInDays(value FHIR.Duration):
    </a:s>
               <a:s r="1573">
                  <a:s r="1573">
                     <a:s>case
      </a:s>
                     <a:s r="1574">
                        <a:s>when </a:s>
                        <a:s r="1581">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1577">
                              <a:s r="1576">
                                 <a:s r="1575">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1576">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1577">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1578">
                              <a:s>'a'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1582">
                           <a:s r="1585">
                              <a:s r="1584">
                                 <a:s r="1583">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1584">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1585">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="1586"> * 365.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1589">
                        <a:s>when </a:s>
                        <a:s r="1596">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1592">
                              <a:s r="1591">
                                 <a:s r="1590">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1591">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1592">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1593">
                              <a:s>'mo'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1597">
                           <a:s r="1600">
                              <a:s r="1599">
                                 <a:s r="1598">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1599">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1600">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="1601"> * 30.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1604">
                        <a:s>when </a:s>
                        <a:s r="1611">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1607">
                              <a:s r="1606">
                                 <a:s r="1605">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1606">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1607">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1608">
                              <a:s>'wk'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1612">
                           <a:s r="1615">
                              <a:s r="1614">
                                 <a:s r="1613">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1614">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1615">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="1616"> * 7.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1619">
                        <a:s>when </a:s>
                        <a:s r="1626">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1622">
                              <a:s r="1621">
                                 <a:s r="1620">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1621">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1622">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1623">
                              <a:s>'d'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1629">
                           <a:s r="1628">
                              <a:s r="1627">
                                 <a:s>value</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1628">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1629">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1630">
                        <a:s>when </a:s>
                        <a:s r="1637">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1633">
                              <a:s r="1632">
                                 <a:s r="1631">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1632">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1633">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1634">
                              <a:s>'h'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1638">
                           <a:s r="1641">
                              <a:s r="1640">
                                 <a:s r="1639">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1640">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1641">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="1642"> / 24.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1645">
                        <a:s>when </a:s>
                        <a:s r="1652">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1648">
                              <a:s r="1647">
                                 <a:s r="1646">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1647">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1648">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1649">
                              <a:s>'min'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1653">
                           <a:s r="1654">
                              <a:s r="1657">
                                 <a:s r="1656">
                                    <a:s r="1655">
                                       <a:s>value</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1656">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1657">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="1658"> / 60.0</a:s>
                           </a:s>
                           <a:s r="1661"> / 24.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1664">
                        <a:s>when </a:s>
                        <a:s r="1671">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1667">
                              <a:s r="1666">
                                 <a:s r="1665">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1666">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1667">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1668">
                              <a:s>'s'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1672">
                           <a:s r="1673">
                              <a:s r="1674">
                                 <a:s r="1677">
                                    <a:s r="1676">
                                       <a:s r="1675">
                                          <a:s>value</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1676">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1677">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s r="1678"> / 60.0</a:s>
                              </a:s>
                              <a:s r="1681"> / 60.0</a:s>
                           </a:s>
                           <a:s r="1684"> / 24.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="1687">
                        <a:s>when </a:s>
                        <a:s r="1694">
                           <a:s>StartsWith(</a:s>
                           <a:s r="1690">
                              <a:s r="1689">
                                 <a:s r="1688">
                                    <a:s>value</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1689">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1690">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="1691">
                              <a:s>'ms'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="1695">
                           <a:s r="1696">
                              <a:s r="1697">
                                 <a:s r="1698">
                                    <a:s r="1701">
                                       <a:s r="1700">
                                          <a:s r="1699">
                                             <a:s>value</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1700">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1701">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s r="1702"> / 60.0</a:s>
                                 </a:s>
                                 <a:s r="1705"> / 60.0</a:s>
                              </a:s>
                              <a:s r="1708"> / 24.0</a:s>
                           </a:s>
                           <a:s r="1711"> / 1000.0</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      else </a:s>
                     <a:s r="1721">
                        <a:s r="1714">Message(1000, true, </a:s>
                        <a:s r="1716">
                           <a:s>'Undefined'</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="1717">
                           <a:s>'Error'</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="1718">
                           <a:s>'Unsupported duration unit'</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
    end</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1573" locator="204:5-214:7" xsi:type="Case">
            <caseItem localId="1574" locator="205:7-205:75">
               <when localId="1581" locator="205:12-205:44" xsi:type="StartsWith">
                  <operand localId="1577" locator="205:23-205:38" path="value" xsi:type="Property">
                     <source localId="1576" locator="205:23-205:32" path="unit" xsi:type="Property">
                        <source localId="1575" locator="205:23-205:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1578" locator="205:41-205:43" valueType="t:String" value="a" xsi:type="Literal"/>
               </when>
               <then localId="1582" locator="205:51-205:75" xsi:type="Multiply">
                  <signature localId="1587" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1588" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1585" locator="205:51-205:67" path="value" xsi:type="Property">
                     <source localId="1584" locator="205:51-205:61" path="value" xsi:type="Property">
                        <source localId="1583" locator="205:51-205:55" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1586" locator="205:71-205:75" valueType="t:Decimal" value="365.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1589" locator="206:7-206:75">
               <when localId="1596" locator="206:12-206:45" xsi:type="StartsWith">
                  <operand localId="1592" locator="206:23-206:38" path="value" xsi:type="Property">
                     <source localId="1591" locator="206:23-206:32" path="unit" xsi:type="Property">
                        <source localId="1590" locator="206:23-206:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1593" locator="206:41-206:44" valueType="t:String" value="mo" xsi:type="Literal"/>
               </when>
               <then localId="1597" locator="206:52-206:75" xsi:type="Multiply">
                  <signature localId="1602" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1603" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1600" locator="206:52-206:68" path="value" xsi:type="Property">
                     <source localId="1599" locator="206:52-206:62" path="value" xsi:type="Property">
                        <source localId="1598" locator="206:52-206:56" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1601" locator="206:72-206:75" valueType="t:Decimal" value="30.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1604" locator="207:7-207:74">
               <when localId="1611" locator="207:12-207:45" xsi:type="StartsWith">
                  <operand localId="1607" locator="207:23-207:38" path="value" xsi:type="Property">
                     <source localId="1606" locator="207:23-207:32" path="unit" xsi:type="Property">
                        <source localId="1605" locator="207:23-207:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1608" locator="207:41-207:44" valueType="t:String" value="wk" xsi:type="Literal"/>
               </when>
               <then localId="1612" locator="207:52-207:74" xsi:type="Multiply">
                  <signature localId="1617" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1618" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1615" locator="207:52-207:68" path="value" xsi:type="Property">
                     <source localId="1614" locator="207:52-207:62" path="value" xsi:type="Property">
                        <source localId="1613" locator="207:52-207:56" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1616" locator="207:72-207:74" valueType="t:Decimal" value="7.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1619" locator="208:7-208:67">
               <when localId="1626" locator="208:12-208:44" xsi:type="StartsWith">
                  <operand localId="1622" locator="208:23-208:38" path="value" xsi:type="Property">
                     <source localId="1621" locator="208:23-208:32" path="unit" xsi:type="Property">
                        <source localId="1620" locator="208:23-208:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1623" locator="208:41-208:43" valueType="t:String" value="d" xsi:type="Literal"/>
               </when>
               <then localId="1629" locator="208:51-208:67" path="value" xsi:type="Property">
                  <source localId="1628" locator="208:51-208:61" path="value" xsi:type="Property">
                     <source localId="1627" locator="208:51-208:55" name="value" xsi:type="OperandRef"/>
                  </source>
               </then>
            </caseItem>
            <caseItem localId="1630" locator="209:7-209:74">
               <when localId="1637" locator="209:12-209:44" xsi:type="StartsWith">
                  <operand localId="1633" locator="209:23-209:38" path="value" xsi:type="Property">
                     <source localId="1632" locator="209:23-209:32" path="unit" xsi:type="Property">
                        <source localId="1631" locator="209:23-209:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1634" locator="209:41-209:43" valueType="t:String" value="h" xsi:type="Literal"/>
               </when>
               <then localId="1638" locator="209:51-209:74" xsi:type="Divide">
                  <signature localId="1643" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1644" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1641" locator="209:51-209:67" path="value" xsi:type="Property">
                     <source localId="1640" locator="209:51-209:61" path="value" xsi:type="Property">
                        <source localId="1639" locator="209:51-209:55" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1642" locator="209:71-209:74" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1645" locator="210:7-210:83">
               <when localId="1652" locator="210:12-210:46" xsi:type="StartsWith">
                  <operand localId="1648" locator="210:23-210:38" path="value" xsi:type="Property">
                     <source localId="1647" locator="210:23-210:32" path="unit" xsi:type="Property">
                        <source localId="1646" locator="210:23-210:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1649" locator="210:41-210:45" valueType="t:String" value="min" xsi:type="Literal"/>
               </when>
               <then localId="1653" locator="210:53-210:83" xsi:type="Divide">
                  <signature localId="1662" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1663" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1654" locator="210:53-210:76" xsi:type="Divide">
                     <signature localId="1659" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1660" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1657" locator="210:53-210:69" path="value" xsi:type="Property">
                        <source localId="1656" locator="210:53-210:63" path="value" xsi:type="Property">
                           <source localId="1655" locator="210:53-210:57" name="value" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                     <operand localId="1658" locator="210:73-210:76" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1661" locator="210:80-210:83" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1664" locator="211:7-211:88">
               <when localId="1671" locator="211:12-211:44" xsi:type="StartsWith">
                  <operand localId="1667" locator="211:23-211:38" path="value" xsi:type="Property">
                     <source localId="1666" locator="211:23-211:32" path="unit" xsi:type="Property">
                        <source localId="1665" locator="211:23-211:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1668" locator="211:41-211:43" valueType="t:String" value="s" xsi:type="Literal"/>
               </when>
               <then localId="1672" locator="211:51-211:88" xsi:type="Divide">
                  <signature localId="1685" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1686" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1673" locator="211:51-211:81" xsi:type="Divide">
                     <signature localId="1682" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1683" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1674" locator="211:51-211:74" xsi:type="Divide">
                        <signature localId="1679" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1680" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1677" locator="211:51-211:67" path="value" xsi:type="Property">
                           <source localId="1676" locator="211:51-211:61" path="value" xsi:type="Property">
                              <source localId="1675" locator="211:51-211:55" name="value" xsi:type="OperandRef"/>
                           </source>
                        </operand>
                        <operand localId="1678" locator="211:71-211:74" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                     </operand>
                     <operand localId="1681" locator="211:78-211:81" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1684" locator="211:85-211:88" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="1687" locator="212:7-212:98">
               <when localId="1694" locator="212:12-212:45" xsi:type="StartsWith">
                  <operand localId="1690" locator="212:23-212:38" path="value" xsi:type="Property">
                     <source localId="1689" locator="212:23-212:32" path="unit" xsi:type="Property">
                        <source localId="1688" locator="212:23-212:27" name="value" xsi:type="OperandRef"/>
                     </source>
                  </operand>
                  <operand localId="1691" locator="212:41-212:44" valueType="t:String" value="ms" xsi:type="Literal"/>
               </when>
               <then localId="1695" locator="212:52-212:98" xsi:type="Divide">
                  <signature localId="1712" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1713" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1696" locator="212:52-212:89" xsi:type="Divide">
                     <signature localId="1709" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1710" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1697" locator="212:52-212:82" xsi:type="Divide">
                        <signature localId="1706" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1707" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1698" locator="212:52-212:75" xsi:type="Divide">
                           <signature localId="1703" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1704" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1701" locator="212:52-212:68" path="value" xsi:type="Property">
                              <source localId="1700" locator="212:52-212:62" path="value" xsi:type="Property">
                                 <source localId="1699" locator="212:52-212:56" name="value" xsi:type="OperandRef"/>
                              </source>
                           </operand>
                           <operand localId="1702" locator="212:72-212:75" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                        </operand>
                        <operand localId="1705" locator="212:79-212:82" valueType="t:Decimal" value="60.0" xsi:type="Literal"/>
                     </operand>
                     <operand localId="1708" locator="212:86-212:89" valueType="t:Decimal" value="24.0" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1711" locator="212:93-212:98" valueType="t:Decimal" value="1000.0" xsi:type="Literal"/>
               </then>
            </caseItem>
            <else localId="1723" xsi:type="ToDecimal">
               <signature localId="1724" name="t:Integer" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1721" locator="213:12-213:81" xsi:type="Message">
                  <source localId="1714" locator="213:20-213:23" valueType="t:Integer" value="1000" xsi:type="Literal"/>
                  <condition localId="1715" locator="213:26-213:29" valueType="t:Boolean" value="true" xsi:type="Literal"/>
                  <code localId="1716" locator="213:32-213:42" valueType="t:String" value="Undefined" xsi:type="Literal"/>
                  <severity localId="1717" locator="213:45-213:51" valueType="t:String" value="Error" xsi:type="Literal"/>
                  <message localId="1718" locator="213:54-213:80" valueType="t:String" value="Unsupported duration unit" xsi:type="Literal"/>
               </operand>
            </else>
         </expression>
         <operand localId="1233" name="value">
            <operandTypeSpecifier localId="1232" locator="203:43-203:55" name="fhir:Duration" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1725" locator="216:1-217:53" name="GetIngredient" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1725">
               <a:s>define function GetIngredient(rxNormCode Code):
  </a:s>
               <a:s r="1738">
                  <a:s r="1738">
                     <a:s r="1730">
                        <a:s r="1728">
                           <a:s>OMTKLogic</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1730">
                           <a:s>GetIngredients(</a:s>
                           <a:s r="1729">
                              <a:s>rxNormCode</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>.</a:s>
                     <a:s r="1738">
                        <a:s>ingredientName</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1738" locator="217:3-217:53" xsi:type="Query">
            <source localId="1737" alias="$this">
               <expression localId="1730" locator="217:3-217:38" name="GetIngredients" libraryName="OMTKLogic" xsi:type="FunctionRef">
                  <operand localId="1729" locator="217:28-217:37" name="rxNormCode" xsi:type="OperandRef"/>
               </expression>
            </source>
            <where localId="1734" xsi:type="Not">
               <operand localId="1733" xsi:type="IsNull">
                  <operand localId="1732" path="ingredientName" xsi:type="Property">
                     <source localId="1731" name="$this" xsi:type="AliasRef"/>
                  </operand>
               </operand>
            </where>
            <return localId="1739" distinct="false">
               <expression localId="1736" path="ingredientName" xsi:type="Property">
                  <source localId="1735" name="$this" xsi:type="AliasRef"/>
               </expression>
            </return>
         </expression>
         <operand localId="1727" name="rxNormCode">
            <operandTypeSpecifier localId="1726" locator="216:42-216:45" name="t:Code" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1740" locator="219:1-220:43" name="GetIngredients" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1740">
               <a:s>define function GetIngredients(rxNormCodes List&lt;Code>):
  </a:s>
               <a:s r="1749">
                  <a:s r="1749">
                     <a:s>
                        <a:s r="1744">
                           <a:s r="1745">
                              <a:s>
                                 <a:s>rxNormCodes</a:s>
                              </a:s>
                           </a:s>
                           <a:s> rnc</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="1746">
                        <a:s>return </a:s>
                        <a:s r="1748">
                           <a:s>GetIngredient(</a:s>
                           <a:s r="1747">
                              <a:s>rnc</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1749" locator="220:3-220:43" xsi:type="Query">
            <source localId="1744" locator="220:3-220:17" alias="rnc">
               <expression localId="1745" locator="220:3-220:13" name="rxNormCodes" xsi:type="OperandRef"/>
            </source>
            <return localId="1746" locator="220:19-220:43">
               <expression localId="1748" locator="220:26-220:43" name="GetIngredient" xsi:type="FunctionRef">
                  <operand localId="1747" locator="220:40-220:42" name="rnc" xsi:type="AliasRef"/>
               </expression>
            </return>
         </expression>
         <operand localId="1743" name="rxNormCodes">
            <operandTypeSpecifier localId="1741" locator="219:44-219:53" xsi:type="ListTypeSpecifier">
               <elementType localId="1742" locator="219:49-219:52" name="t:Code" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1750" locator="222:1-224:89" name="GetMedicationNames" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1750">
               <a:s>define function GetMedicationNames(medications List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1800">
                  <a:s r="1800">
                     <a:s>
                        <a:s r="1754">
                           <a:s r="1755">
                              <a:s>
                                 <a:s>medications</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1756">
                        <a:s>return </a:s>
                        <a:s r="1798">
                           <a:s r="1789">
                              <a:s r="1780">
                                 <a:s r="1757">
                                    <a:s>OMTKLogic</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1780">
                                    <a:s>GetIngredients(</a:s>
                                    <a:s r="1765">
                                       <a:s>ToRxNormCode(</a:s>
                                       <a:s r="1760">
                                          <a:s r="1759">
                                             <a:s r="1758">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1759">
                                                <a:s>medication</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1760">
                                             <a:s>coding</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1789">
                                 <a:s>rxNormCode</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1798">
                              <a:s>display</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1800" locator="223:3-224:89" xsi:type="Query">
            <source localId="1754" locator="223:3-223:15" alias="M">
               <expression localId="1755" locator="223:3-223:13" name="medications" xsi:type="OperandRef"/>
            </source>
            <return localId="1756" locator="224:5-224:89">
               <expression localId="1798" locator="224:12-224:89" xsi:type="Query">
                  <source localId="1797" alias="$this">
                     <expression localId="1789" locator="224:12-224:81" xsi:type="Query">
                        <source localId="1788" alias="$this">
                           <expression localId="1780" locator="224:12-224:70" name="GetIngredients" libraryName="OMTKLogic" xsi:type="FunctionRef">
                              <operand localId="1781" name="ToCode" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="1765" locator="224:37-224:69" name="ToRxNormCode" xsi:type="FunctionRef">
                                    <operand localId="1760" locator="224:50-224:68" path="coding" xsi:type="Property">
                                       <source localId="1759" locator="224:50-224:61" path="medication" scope="M" xsi:type="Property"/>
                                    </operand>
                                 </operand>
                              </operand>
                           </expression>
                        </source>
                        <where localId="1785" xsi:type="Not">
                           <operand localId="1784" xsi:type="IsNull">
                              <operand localId="1783" path="rxNormCode" xsi:type="Property">
                                 <source localId="1782" name="$this" xsi:type="AliasRef"/>
                              </operand>
                           </operand>
                        </where>
                        <return localId="1790" distinct="false">
                           <expression localId="1787" path="rxNormCode" xsi:type="Property">
                              <source localId="1786" name="$this" xsi:type="AliasRef"/>
                           </expression>
                        </return>
                     </expression>
                  </source>
                  <where localId="1794" xsi:type="Not">
                     <operand localId="1793" xsi:type="IsNull">
                        <operand localId="1792" path="display" xsi:type="Property">
                           <source localId="1791" name="$this" xsi:type="AliasRef"/>
                        </operand>
                     </operand>
                  </where>
                  <return localId="1799" distinct="false">
                     <expression localId="1796" path="display" xsi:type="Property">
                        <source localId="1795" name="$this" xsi:type="AliasRef"/>
                     </expression>
                  </return>
               </expression>
            </return>
         </expression>
         <operand localId="1753" name="medications">
            <operandTypeSpecifier localId="1751" locator="222:48-222:70" xsi:type="ListTypeSpecifier">
               <elementType localId="1752" locator="222:53-222:69" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1761" locator="241:1-244:3" name="ToRxNormCode" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1761">
               <a:s>define function ToRxNormCode(coding List&lt;FHIR.Coding>):
  </a:s>
               <a:s r="1821">
                  <a:s r="1821">
                     <a:s>singleton from </a:s>
                     <a:s r="1832">
                        <a:s>(
    </a:s>
                        <a:s r="1832">
                           <a:s>
                              <a:s r="1822">
                                 <a:s r="1823">
                                    <a:s>
                                       <a:s>coding</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> C</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="1824">
                              <a:s>where </a:s>
                              <a:s r="1824">
                                 <a:s r="1826">
                                    <a:s r="1825">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1826">
                                       <a:s>system</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1827">
                                    <a:s>'http://www.nlm.nih.gov/research/umls/rxnorm'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1821" locator="242:3-244:3" xsi:type="SingletonFrom">
            <signature localId="1833" xsi:type="ListTypeSpecifier">
               <elementType localId="1834" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="1832" locator="242:18-244:3" xsi:type="Query">
               <source localId="1822" locator="243:5-243:12" alias="C">
                  <expression localId="1823" locator="243:5-243:10" name="coding" xsi:type="OperandRef"/>
               </source>
               <where localId="1824" locator="243:14-243:75" xsi:type="Equal">
                  <signature localId="1830" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1831" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1828" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="1829" name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1826" locator="243:20-243:27" path="system" scope="C" xsi:type="Property"/>
                  </operand>
                  <operand localId="1827" locator="243:31-243:75" valueType="t:String" value="http://www.nlm.nih.gov/research/umls/rxnorm" xsi:type="Literal"/>
               </where>
            </operand>
         </expression>
         <operand localId="1764" name="coding">
            <operandTypeSpecifier localId="1762" locator="241:37-241:53" xsi:type="ListTypeSpecifier">
               <elementType localId="1763" locator="241:42-241:52" name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
   </statements>
</library>
